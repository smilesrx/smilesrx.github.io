<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"smilesrx.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="虾米">
<meta property="og:type" content="website">
<meta property="og:title" content="逆玺之路">
<meta property="og:url" content="https://smilesrx.github.io/page/2/index.html">
<meta property="og:site_name" content="逆玺之路">
<meta property="og:description" content="虾米">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="CandyKing">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://smilesrx.github.io/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>逆玺之路</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">逆玺之路</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smilesrx.github.io/2021/04/21/C++/C++%E7%B1%BB%E6%A8%A1%E6%9D%BF%E5%B0%81%E8%A3%85%E4%BB%BB%E6%84%8F%E7%B1%BB%E5%9E%8B%E6%95%B0%E7%BB%84/C++%E7%B1%BB%E6%A8%A1%E6%9D%BF%E5%B0%81%E8%A3%85%E4%BB%BB%E6%84%8F%E6%95%B0%E7%BB%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CandyKing">
      <meta itemprop="description" content="虾米">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆玺之路">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/21/C++/C++%E7%B1%BB%E6%A8%A1%E6%9D%BF%E5%B0%81%E8%A3%85%E4%BB%BB%E6%84%8F%E7%B1%BB%E5%9E%8B%E6%95%B0%E7%BB%84/C++%E7%B1%BB%E6%A8%A1%E6%9D%BF%E5%B0%81%E8%A3%85%E4%BB%BB%E6%84%8F%E6%95%B0%E7%BB%84/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-21 20:23:45" itemprop="dateCreated datePublished" datetime="2021-04-21T20:23:45+08:00">2021-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-21 16:30:09" itemprop="dateModified" datetime="2020-10-21T16:30:09+08:00">2020-10-21</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="类模板封装任意类型数组"><a href="#类模板封装任意类型数组" class="headerlink" title="类模板封装任意类型数组"></a>类模板封装任意类型数组</h1><h1 id="1、任意类型数组类模板"><a href="#1、任意类型数组类模板" class="headerlink" title="1、任意类型数组类模板"></a>1、任意类型数组类模板</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyArray</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MyArray</span>();                        <span class="comment">//默认构造</span></span><br><span class="line">    <span class="built_in">MyArray</span>(<span class="keyword">int</span> capaticy);            <span class="comment">//有参构造</span></span><br><span class="line">    <span class="built_in">MyArray</span>(<span class="keyword">const</span> MyArray &amp;arr);      <span class="comment">//拷贝构造</span></span><br><span class="line">    MyArray&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> MyArray &amp;arr);    <span class="comment">//赋值运算符重载</span></span><br><span class="line">    T&amp; <span class="keyword">operator</span>[](<span class="keyword">int</span> index);                  <span class="comment">//下标运算符重载</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">PushBack</span><span class="params">(T val)</span></span>;                <span class="comment">//尾插法</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pushIndex</span><span class="params">(T val,<span class="keyword">int</span> index)</span></span>;     <span class="comment">//按位置插入 </span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">GetSize</span><span class="params">()</span></span>;            <span class="comment">//获取数组大小</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">GetCapaticy</span><span class="params">()</span></span>;        <span class="comment">//获取数组容量</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Print</span><span class="params">()</span></span>;  <span class="comment">//打印数组  </span></span><br><span class="line">    ~<span class="built_in">MyArray</span>();    <span class="comment">//析构函数</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    T *pAdress;       <span class="comment">//数组地址</span></span><br><span class="line">    <span class="keyword">int</span> m_Capaticy;   <span class="comment">//数组容量</span></span><br><span class="line">    <span class="keyword">int</span> m_Size;       <span class="comment">//数组大小</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h1 id="2、有参构造函数实现"><a href="#2、有参构造函数实现" class="headerlink" title="2、有参构造函数实现"></a>2、有参构造函数实现</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">MyArray&lt;T&gt;::<span class="built_in">MyArray</span>(<span class="keyword">int</span> capaticy)&#123;</span><br><span class="line">	<span class="keyword">this</span>-&gt;m_Capaticy=capaticy;</span><br><span class="line">	<span class="keyword">this</span>-&gt;m_Size=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">this</span>-&gt;pAdress=<span class="keyword">new</span> T[<span class="keyword">this</span>-&gt;m_Capaticy];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="3、拷贝构造函数实现"><a href="#3、拷贝构造函数实现" class="headerlink" title="3、拷贝构造函数实现"></a>3、拷贝构造函数实现</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line">MyArray&lt;T&gt;::<span class="built_in">MyArray</span>(<span class="keyword">const</span> MyArray &amp;arr)&#123;</span><br><span class="line">	<span class="keyword">this</span>-&gt;m_Capaticy=arr.m_Capaticy;</span><br><span class="line">	<span class="keyword">this</span>-&gt;m_Size=arr.m_Size;</span><br><span class="line">	<span class="keyword">this</span>-&gt;pAdress=<span class="keyword">new</span> T[<span class="keyword">this</span>-&gt;m_Capaticy];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="keyword">this</span>-&gt;m_Size;++i)&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;pAdress[i]=arr[i];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="4、赋值运算符重载"><a href="#4、赋值运算符重载" class="headerlink" title="4、赋值运算符重载"></a>4、赋值运算符重载</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line">MyArray&lt;T&gt;&amp; MyArray&lt;T&gt;::<span class="keyword">operator</span>=(<span class="keyword">const</span> MyArray &amp;arr)&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">this</span>-&gt;pAdress)&#123;</span><br><span class="line">		<span class="keyword">delete</span>[] <span class="keyword">this</span>-&gt;pAdress;</span><br><span class="line">		<span class="keyword">this</span>-&gt;pAdress=<span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">this</span>-&gt;m_Capaticy=arr.m_Capaticy;</span><br><span class="line">	<span class="keyword">this</span>-&gt;m_Size=arr.m_Size;</span><br><span class="line">	<span class="keyword">this</span>-&gt;pAdress=<span class="keyword">new</span> T[<span class="keyword">this</span>-&gt;m_Capaticy];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="keyword">this</span>-&gt;m_Size;++i)&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;pAdress[i]=arr[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="5、下标运算符重载"><a href="#5、下标运算符重载" class="headerlink" title="5、下标运算符重载"></a>5、下标运算符重载</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">template &lt;class T&gt;</span><br><span class="line">T&amp; MyArray&lt;T&gt;::operator[](int index)          &#x2F;&#x2F;下标运算符重载</span><br><span class="line">&#123;</span><br><span class="line">	return this-&gt;pAdress[index];</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="6、数组尾插法"><a href="#6、数组尾插法" class="headerlink" title="6、数组尾插法"></a>6、数组尾插法</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="keyword">void</span> MyArray&lt;T&gt;::<span class="built_in">PushBack</span>(T val)&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">this</span>-&gt;m_Capaticy==<span class="keyword">this</span>-&gt;m_Size)</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">this</span>-&gt;pAdress[<span class="keyword">this</span>-&gt;m_Size]=val;</span><br><span class="line">	<span class="keyword">this</span>-&gt;m_Size++;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h1 id="7、数组按位置插入"><a href="#7、数组按位置插入" class="headerlink" title="7、数组按位置插入"></a>7、数组按位置插入</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="keyword">void</span> MyArray&lt;T&gt;::<span class="built_in">pushIndex</span>(T val,<span class="keyword">int</span> index)&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">this</span>-&gt;m_Capaticy==<span class="keyword">this</span>-&gt;m_Size)</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="keyword">this</span>-&gt;m_Size<span class="number">-1</span>;i&gt;=index<span class="number">-1</span>;--i)&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;pAdress[i+<span class="number">1</span>]=<span class="keyword">this</span>-&gt;pAdress[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">this</span>-&gt;pAdress[index<span class="number">-1</span>]=val;</span><br><span class="line">	<span class="keyword">this</span>-&gt;m_Size++;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h1 id="8、获取数组大小"><a href="#8、获取数组大小" class="headerlink" title="8、获取数组大小"></a>8、获取数组大小</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="keyword">int</span> MyArray&lt;T&gt;::<span class="built_in">GetSize</span>()&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">this</span>-&gt;m_Size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="9、获取数组容量"><a href="#9、获取数组容量" class="headerlink" title="9、获取数组容量"></a>9、获取数组容量</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="keyword">int</span> MyArray&lt;T&gt;::<span class="built_in">GetCapaticy</span>()&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">this</span>-&gt;m_Capaticy;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="10、打印数组（整型和字符型）"><a href="#10、打印数组（整型和字符型）" class="headerlink" title="10、打印数组（整型和字符型）"></a>10、打印数组（整型和字符型）</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="keyword">void</span> MyArray&lt;T&gt;::<span class="built_in">Print</span>()&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="keyword">this</span>-&gt;<span class="built_in">GetSize</span>();++i)&#123;</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;<span class="keyword">this</span>-&gt;pAdress[i];</span><br><span class="line">	&#125;</span><br><span class="line">	cout&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<h1 id="11、析构函数实现"><a href="#11、析构函数实现" class="headerlink" title="11、析构函数实现"></a>11、析构函数实现</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line">MyArray&lt;T&gt;::~<span class="built_in">MyArray</span>()&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">this</span>-&gt;pAdress)&#123;</span><br><span class="line">		<span class="keyword">delete</span>[] <span class="keyword">this</span>-&gt;pAdress;</span><br><span class="line">		<span class="keyword">this</span>-&gt;pAdress=<span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="12、整型测试"><a href="#12、整型测试" class="headerlink" title="12、整型测试"></a>12、整型测试</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">MyArray&lt;<span class="keyword">int</span>&gt; <span class="title">myarray</span><span class="params">(<span class="number">50</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;++i)&#123;</span><br><span class="line">		myarray.<span class="built_in">PushBack</span>(i+<span class="number">100</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	myarray.<span class="built_in">Print</span>();</span><br><span class="line">	</span><br><span class="line">	myarray.<span class="built_in">pushIndex</span>(<span class="number">50</span>,<span class="number">7</span>);</span><br><span class="line">	myarray.<span class="built_in">Print</span>();</span><br><span class="line">	myarray.<span class="built_in">GetSize</span>();</span><br><span class="line">	myarray.<span class="built_in">GetCapaticy</span>();	</span><br><span class="line">	myarray.<span class="built_in">Print</span>(); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="13、字符型测试"><a href="#13、字符型测试" class="headerlink" title="13、字符型测试"></a>13、字符型测试</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">MyArray&lt;<span class="keyword">char</span>&gt; <span class="title">myarray</span><span class="params">(<span class="number">50</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;++i)&#123;</span><br><span class="line">		myarray.<span class="built_in">PushBack</span>(i+<span class="number">65</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	myarray.<span class="built_in">Print</span>();</span><br><span class="line">	</span><br><span class="line">	myarray.<span class="built_in">pushIndex</span>(<span class="number">97</span>,<span class="number">7</span>);</span><br><span class="line">	myarray.<span class="built_in">Print</span>();</span><br><span class="line">	myarray.<span class="built_in">GetSize</span>();</span><br><span class="line">	myarray.<span class="built_in">GetCapaticy</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="14、自定义类型测试"><a href="#14、自定义类型测试" class="headerlink" title="14、自定义类型测试"></a>14、自定义类型测试</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">friend</span> <span class="keyword">void</span> <span class="title">myPrintPerson</span><span class="params">(MyArray&lt;Person&gt; &amp;myPersonArr)</span></span>;</span><br><span class="line">	<span class="built_in">Person</span>()&#123;&#125;</span><br><span class="line">	<span class="built_in">Person</span>(string name,<span class="keyword">int</span> age)&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;m_Name=name;</span><br><span class="line">		<span class="keyword">this</span>-&gt;m_Age=age;</span><br><span class="line">	&#125;	</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	string m_Name;</span><br><span class="line">	<span class="keyword">int</span> m_Age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">myPrintPerson</span><span class="params">(MyArray&lt;Person&gt; &amp;myPersonArr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; myPersonArr.<span class="built_in">GetSize</span>();i++)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;姓名： &quot;</span> &lt;&lt; myPersonArr[i].m_Name &lt;&lt; <span class="string">&quot; 年龄：&quot;</span> &lt;&lt; myPersonArr[i].m_Age &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test03</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">MyArray&lt;Person&gt; <span class="title">myarray</span><span class="params">(<span class="number">50</span>)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function">Person <span class="title">p1</span><span class="params">(<span class="string">&quot;孙悟空&quot;</span>, <span class="number">1000</span>)</span></span>;</span><br><span class="line">	<span class="function">Person <span class="title">p2</span><span class="params">(<span class="string">&quot;猪八戒&quot;</span>, <span class="number">800</span>)</span></span>;</span><br><span class="line">	<span class="function">Person <span class="title">p3</span><span class="params">(<span class="string">&quot;唐僧&quot;</span>, <span class="number">500</span>)</span></span>;</span><br><span class="line">	<span class="function">Person <span class="title">p4</span><span class="params">(<span class="string">&quot;沙悟净&quot;</span>, <span class="number">300</span>)</span></span>;</span><br><span class="line">	<span class="function">Person <span class="title">p5</span><span class="params">(<span class="string">&quot;白龙马&quot;</span>, <span class="number">10000</span>)</span></span>;</span><br><span class="line">	</span><br><span class="line">	myarray.<span class="built_in">PushBack</span>(p1);</span><br><span class="line">	myarray.<span class="built_in">PushBack</span>(p2);</span><br><span class="line">	myarray.<span class="built_in">PushBack</span>(p3);</span><br><span class="line">	myarray.<span class="built_in">PushBack</span>(p4);</span><br><span class="line">	myarray.<span class="built_in">PushBack</span>(p5);</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">myPrintPerson</span>(myarray);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smilesrx.github.io/2021/04/21/C++/C++%E9%9D%99%E6%80%81%E6%88%90%E5%91%98/C++%E9%9D%99%E6%80%81%E6%88%90%E5%91%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CandyKing">
      <meta itemprop="description" content="虾米">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆玺之路">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/21/C++/C++%E9%9D%99%E6%80%81%E6%88%90%E5%91%98/C++%E9%9D%99%E6%80%81%E6%88%90%E5%91%98/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-21 20:23:45" itemprop="dateCreated datePublished" datetime="2021-04-21T20:23:45+08:00">2021-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-26 20:10:48" itemprop="dateModified" datetime="2020-10-26T20:10:48+08:00">2020-10-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="什么是static"><a href="#什么是static" class="headerlink" title="什么是static"></a>什么是static</h1><p>static 是 C/C++ 中很常用的修饰符，它被用来控制变量的存储方式和可见性。</p>
<h2 id="1、引入static"><a href="#1、引入static" class="headerlink" title="1、引入static"></a>1、引入static</h2><p>我们知道在函数内部定义的变量，当程序执行到它的定义处时，编译器为它在栈上分配空间，函数在栈上分配的空间在此函数执行结束时会释放掉，这样就产生了一个问题: 如果想将函数中此变量的值保存至下一次调用时，如何实现？ 最容易想到的方法是定义为全局的变量，但定义一个全局变量有许多缺点，最明显的缺点是破坏了此变量的访问范围（使得在此函数中定义的变量，不仅仅只受此函数控制）。static 关键字则可以很好的解决这个问题。</p>
<p>另外，在 C++ 中，需要一个数据对象为整个类而非某个对象服务,同时又力求不破坏类的封装性,即要求此成员隐藏在类的内部，对外不可见时，可将其定义为静态数据。</p>
<h2 id="2、静态数据存储"><a href="#2、静态数据存储" class="headerlink" title="2、静态数据存储"></a>2、静态数据存储</h2><ol>
<li><p><strong>全局（静态）存储区</strong>：分为 DATA 段和 BSS 段。</p>
<ul>
<li>DATA 段（全局初始化区）存放初始化的全局变量和静态变量；</li>
<li>BSS 段（全局未初始化区）存放未初始化的全局变量和静态变量。</li>
</ul>
<p>程序运行结束时自动释放。</p>
<p>其中BBS段在程序执行之前会被系统自动清0，所以未初始化的全局变量和静态变量在程序执行之前已经为0。</p>
<p>存储在静态数据区的变量会在程序刚开始运行时就完成初始化，也是唯一的一次初始化。</p>
</li>
<li><p>在 C++ 中 static 的内部实现机制：静态数据成员要在程序一开始运行时就必须存在。因为函数在程序运行中被调用，所以静态数据成员不能在任何函数内分配空间和初始化。故静态数据成员一定要在<strong>类内申明，类外定义</strong>。</p>
<p>注意：</p>
<ul>
<li>静态数据成员要实际地分配空间，故不能在类的声明中定义（只能声明数据成员）。类声明只声明一个类的”尺寸和规格”，并不进行实际的内存分配，所以在类声明中写成定义是错误的。</li>
<li>它也不能在头文件中类声明的外部定义，因为那会造成在多个使用该类的源文件中，对其重复定义。</li>
</ul>
<p>static 被引入以告知编译器，将变量存储在程序的静态存储区而非栈上空间，静态数据成员按定义出现的先后顺序依次初始化，注意静态成员嵌套时，要保证所嵌套的成员已经初始化了。清除时的顺序是初始化的反顺序。</p>
</li>
</ol>
<h1 id="在C中static的作用"><a href="#在C中static的作用" class="headerlink" title="在C中static的作用"></a>在C中static的作用</h1><h2 id="1、static修饰变量"><a href="#1、static修饰变量" class="headerlink" title="1、static修饰变量"></a>1、static修饰变量</h2><ol>
<li><p>修饰局部变量</p>
<ul>
<li><p>普通局部变量：在任何一个函数内部定义的变量（不加static修饰符）</p>
<ul>
<li>作用域：局部作用域</li>
<li>生命周期：函数结束时被清理</li>
<li>编译器一般不对普通局部变量进行初始化，也就是说它的值在初始时是不确定的，除非对其显式赋值。</li>
<li>普通局部变量存储于<strong>进程栈空间</strong>，使用完毕会立即释放。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> variable;   <span class="comment">//未初始化，结果不定</span></span><br><span class="line">    <span class="keyword">int</span> variable1=<span class="number">10</span>;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;variable=&quot;</span>&lt;&lt;variable&lt;&lt;<span class="string">&quot; variable1=&quot;</span>&lt;&lt;variable1&lt;&lt;endl;</span><br><span class="line">    variable1++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">func</span>();   <span class="comment">//variable=4254465 variable1=10 </span></span><br><span class="line">    <span class="comment">//cout&lt;&lt;&quot;variable=&quot;&lt;&lt;variable&lt;&lt;&quot; variable1=&quot;&lt;&lt;variable1&lt;&lt;endl;  //作用域：局部，func函数外部不可见</span></span><br><span class="line">    <span class="comment">//[Error] &#x27;variable&#x27; was not declared in this scope</span></span><br><span class="line">    <span class="comment">//[Error] &#x27;variable1&#x27; was not declared in this scope</span></span><br><span class="line">    <span class="built_in">func</span>();   <span class="comment">//variable=4254465 variable1=10    //被再次初始化</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>静态局部变量：使用static修饰符定义在任何一个函数内部定义的变量</p>
<ul>
<li><p>作用域：局部作用域</p>
</li>
<li><p>生命周期：程序结束时被清理</p>
</li>
<li><p>即使在声明时未赋初值，编译器也会把它初始化为0。</p>
</li>
<li><p>在首次执行到申明或定义处时被初始化，下次函数调用不会被再次初始化（只进行一次初始化操作）</p>
</li>
<li><p>静态局部变量存储于进程的<strong>全局数据区</strong>，即使函数返回，它的值也会保持不变。</p>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> variable;   <span class="comment">//被系统初始化为0</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> variable1=<span class="number">10</span>;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;variable=&quot;</span>&lt;&lt;variable&lt;&lt;<span class="string">&quot; variable1=&quot;</span>&lt;&lt;variable1&lt;&lt;endl;</span><br><span class="line">    variable1++;    <span class="comment">//variable1=11</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">func</span>();     <span class="comment">//variable=0 variable1=10 </span></span><br><span class="line">    <span class="comment">//cout&lt;&lt;&quot;variable=&quot;&lt;&lt;variable&lt;&lt;&quot; variable1=&quot;&lt;&lt;variable1&lt;&lt;endl;  //作用域：局部，func函数外部不可见</span></span><br><span class="line">    <span class="comment">//[Error] &#x27;variable&#x27; was not declared in this scope</span></span><br><span class="line">    <span class="comment">//[Error] &#x27;variable1&#x27; was not declared in this scope</span></span><br><span class="line">    <span class="built_in">func</span>();    <span class="comment">//variable=0 variable1=11    //只能进行一次初始化</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>修饰全局变量</p>
<p>全局变量定义在函数体外部，在<strong>全局数据区</strong>分配存储空间，且编译器会自动对其初始化。</p>
<ul>
<li><p>普通全局变量：</p>
<ul>
<li>作用域：对整个工程可见，其他文件可以使用extern外部声明后直接使用</li>
<li>其他文件不能再定义一个与其相同名字的变量了（否则编译器会认为它们是同一个变量）</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main.c</span></span><br><span class="line"><span class="keyword">int</span> variable;   <span class="comment">//被系统初始化为0</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;variable=&quot;</span>&lt;&lt;variable&lt;&lt;endl;    <span class="comment">//variable=0 </span></span><br><span class="line">    variable++;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;variable=&quot;</span>&lt;&lt;variable&lt;&lt;endl;    <span class="comment">//variable=1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//other.c</span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span> varlable;  <span class="comment">//其他文件外部使用</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> variable;   <span class="comment">//重定义（错）</span></span><br></pre></td></tr></table></figure></li>
<li><p>静态全局变量：</p>
<ul>
<li>作用域：仅对当前文件可见，其他文件不可访问</li>
<li>其他文件可以定义与其同名的变量，两者互不影响</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main.c</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> variable;   <span class="comment">//被系统初始化为0</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;variable=&quot;</span>&lt;&lt;variable&lt;&lt;endl;        <span class="comment">//variable=0  </span></span><br><span class="line">    variable=<span class="number">20</span>;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;variable=&quot;</span>&lt;&lt;variable&lt;&lt;endl;        <span class="comment">//variable=20 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//other.c</span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span> varlable;  <span class="comment">//其他文件外部不可访问（错）</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> variable;   <span class="comment">//外部文件自定义变量--不冲突</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h2 id="2、static修饰函数"><a href="#2、static修饰函数" class="headerlink" title="2、static修饰函数"></a>2、static修饰函数</h2><p>函数的使用方式与全局变量类似，在函数的返回类型前加上static，就是静态函数，其特性如下：</p>
<ul>
<li><p>静态函数只能在声明它的文件中可见，其他文件不能引用该函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main.c</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">funcA</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;调用funcA函数&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">funcA</span>();</span><br><span class="line">    <span class="built_in">funcB</span>();   <span class="comment">//报错，在本文件（main.c）找不到funcB()这个函数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//other.c</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">funcB</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;调用funcB函数&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>不同的文件可以使用相同名字的静态函数，互不影响</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//file1.c</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;flie1.c文件下调用func函数&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">func</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//file2.c</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     cout&lt;&lt;<span class="string">&quot;flie2.c文件下调用func函数&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">func</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//main.c</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">test1</span>();    <span class="comment">//flie1.c文件下调用func函数</span></span><br><span class="line">    <span class="built_in">test2</span>();    <span class="comment">//flie2.c文件下调用func函数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="在C-中static的作用"><a href="#在C-中static的作用" class="headerlink" title="在C++中static的作用"></a>在C++中static的作用</h1><h2 id="1、static修饰变量（类成员变量）"><a href="#1、static修饰变量（类成员变量）" class="headerlink" title="1、static修饰变量（类成员变量）"></a>1、static修饰变量（类成员变量）</h2><p>在类内的数据成员前加static关键字修饰，使之成为类内的静态成员</p>
<ol>
<li><p>特点：</p>
<ul>
<li><p>静态数据成员存储在全局数据区，静态数据成员在定义时分配存储空间，所以不能在类声明中定义（在类内申明，类外定义）</p>
<p>类外定义语法：<code>数据类型 类名:: 静态数据成员名=变量值</code></p>
</li>
<li><p>属于类的静态静态资源（只有一个拷贝）</p>
</li>
<li><p>不属于某个对象，在没有实例对象时可直接用类名访问</p>
<p><code>类名::类内的静态数据成员</code></p>
<p>在为对象分配空间中不包括静态成员所占空间。</p>
</li>
<li><p>所有对象共享这个资源，可通过类对象访问</p>
<p><code>对象名.类内的静态数据成员</code></p>
</li>
<li><p>和普通数据成员一样，静态数据成员也遵从<code>public, protected, private</code>访问规则</p>
</li>
</ul>
</li>
<li><p>作用：</p>
<ul>
<li>解决与程序中其它全局名字冲突的问题</li>
<li>实现信息隐藏。静态数据成员可以是private成员，而全局变量不能</li>
</ul>
</li>
<li><p>源码示例：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//类的静态成员属性</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> m_Number;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> m_Age;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//类外初始化，初始化时不加static</span></span><br><span class="line"><span class="keyword">int</span> Student::m_Number=<span class="number">1001</span>;</span><br><span class="line"><span class="keyword">int</span> Student::m_Age=<span class="number">15</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//1. 通过类名直接访问</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;Student::m_Number--学号：&quot;</span>&lt;&lt;Student::m_Number&lt;&lt;endl;     <span class="comment">//Student::m_Number--学号：1001 </span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//2. 通过对象访问</span></span><br><span class="line">    Student stu;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;stu.m_Number--学号：&quot;</span>&lt;&lt;stu.m_Number&lt;&lt;endl;        <span class="comment">//stu.m_Number--学号：1001 </span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//3. 静态成员也有访问权限，类外不能访问私有成员</span></span><br><span class="line">    <span class="comment">//cout&lt;&lt;&quot;年龄：&quot;&lt;&lt;Student::m_Age&lt;&lt;endl;</span></span><br><span class="line">    Student stu1;</span><br><span class="line">    <span class="comment">//cout&lt;&lt;&quot;年龄：&quot;&lt;&lt;stu1.m_Age&lt;&lt;endl;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="2、static修饰函数（类成员函数）"><a href="#2、static修饰函数（类成员函数）" class="headerlink" title="2、static修饰函数（类成员函数）"></a>2、static修饰函数（类成员函数）</h2><p>在类定义中，前面有static说明的成员函数称为静态成员函数</p>
<ol>
<li><p>特点：</p>
<ul>
<li>静态成员函数属于整个类，而不属于某一个对象,只有一份拷贝</li>
</ul>
</li>
</ol>
<ul>
<li>在对象没有创建前，即可通过类名调用<ul>
<li>静态成员函数没有this指针，它无法访问属于类对象的非静态数据成员，也无法访问非静态成员函数，它只能调用静态数据成员和静态成员函数</li>
<li>非静态成员函数可以任意地访问静态成员函数和静态数据成员</li>
<li>静态成员函数也有访问权限</li>
</ul>
</li>
</ul>
<ol start="2">
<li><p>代码示例</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//普通成员函数</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">funcA</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;m_Name=<span class="string">&quot;夏侯惇&quot;</span>;</span><br><span class="line">        <span class="keyword">this</span>-&gt;m_Age=<span class="number">28</span>;</span><br><span class="line">		<span class="keyword">this</span>-&gt;m_Number=<span class="string">&quot;1002&quot;</span>; </span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;m_Name&lt;&lt;<span class="string">&quot; 年龄：&quot;</span>&lt;&lt;m_Age&lt;&lt;<span class="string">&quot; 学号：&quot;</span>&lt;&lt;m_Number&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//静态成员函数</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">funcB</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//this-&gt;m_Name=&quot;老夫子&quot;;  //不能访问非静态成员(没有this指针)</span></span><br><span class="line">        <span class="comment">//this-&gt;m_Age=26;</span></span><br><span class="line">        m_Number=<span class="string">&quot;1003&quot;</span>;</span><br><span class="line">    	cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;<span class="string">&quot;无法访问&quot;</span>&lt;&lt;<span class="string">&quot; 年龄：&quot;</span>&lt;&lt;m_Age&lt;&lt;<span class="string">&quot; 学号：&quot;</span>&lt;&lt;m_Number&lt;&lt;endl;   </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//类的静态成员属性</span></span><br><span class="line">    string m_Name;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> m_Age;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">funcC</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//this-&gt;m_Name=&quot;凯爹&quot;;  //不能访问非静态成员(没有this指针)</span></span><br><span class="line">        <span class="comment">//this-&gt;m_Age=26;</span></span><br><span class="line">    	m_Number=<span class="string">&quot;1004&quot;</span>;</span><br><span class="line">    	cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;<span class="string">&quot;无法访问&quot;</span>&lt;&lt;<span class="string">&quot; 年龄：&quot;</span>&lt;&lt;m_Age&lt;&lt;<span class="string">&quot; 学号：&quot;</span>&lt;&lt;m_Number&lt;&lt;endl;  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> string m_Number;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//静态成员属性类外初始化</span></span><br><span class="line"><span class="keyword">int</span> Person::m_Age=<span class="number">15</span>;</span><br><span class="line">string Person::m_Number=<span class="string">&quot;1001&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//1. 类名直接调用--静态成员函数</span></span><br><span class="line">    Person::<span class="built_in">funcB</span>();    <span class="comment">//姓名：无法访问 年龄：15 学号：1003 </span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//2. 通过对象调用</span></span><br><span class="line">    Person person;</span><br><span class="line">    person.<span class="built_in">funcA</span>();       <span class="comment">//姓名：夏侯惇 年龄：28 学号：1002 </span></span><br><span class="line">    person.<span class="built_in">funcB</span>();       <span class="comment">//姓名：无法访问 年龄：28 学号：1003 </span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//3. 静态成员函数也有访问权限</span></span><br><span class="line">    <span class="comment">//Person::funcC();</span></span><br><span class="line">    Person person1;</span><br><span class="line">    <span class="comment">//person1.funcC();</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="3、const静态成员属性"><a href="#3、const静态成员属性" class="headerlink" title="3、const静态成员属性"></a>3、const静态成员属性</h2><p>如果一个类的成员，既要实现共享，又要实现不可改变，那就用 static const 修饰。</p>
<p><strong>定义静态<code>const</code>数据成员时，最好在类内部初始化</strong>。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    string m_Name;</span><br><span class="line">    <span class="built_in">Person</span>(string name):<span class="built_in">m_Name</span>(name)&#123;&#125;;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> m_Age=<span class="number">30</span>;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> m_Money=<span class="number">1000000</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Person <span class="title">person</span><span class="params">(<span class="string">&quot;貂蝉&quot;</span>)</span></span>;            <span class="comment">//姓名：貂蝉 年龄：30 身家：1000000 </span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;person.m_Name&lt;&lt;<span class="string">&quot; 年龄：&quot;</span>&lt;&lt;person.m_Age&lt;&lt;<span class="string">&quot; 身家：&quot;</span>&lt;&lt;person.m_Money&lt;&lt;endl;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//不可修改 </span></span><br><span class="line">    <span class="comment">//person.m_Age=45;  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="静态成员实现单例模式"><a href="#静态成员实现单例模式" class="headerlink" title="静态成员实现单例模式"></a>静态成员实现单例模式</h1><h2 id="1、单例模式"><a href="#1、单例模式" class="headerlink" title="1、单例模式"></a>1、单例模式</h2><p>单例模式是一种常用的软件设计模式。在它的核心结构中只包含一个被称为单例的特殊类。</p>
<p>通过单例模式可以保证系统中一个类只有一个实例而且该实例易于外界访问，从而方便对实例个数的控制并节约系统资源。</p>
<p>如果希望在系统中某个类的对象只能存在一个，单例模式是最好的解决方案。</p>
<p>Singleton（单例）：在单例类的内部实现只生成一个实例，同时它提供一个静态的<code>getInstance()</code>工厂方法，让客户可以访问它的唯一实例；为了防止在外部对其实例化，<strong>将其默认构造函数和拷贝构造函数设计为私有</strong>；在单例类内部定义了一个Singleton类型的静态对象，作为外部共享的唯一实例。</p>
<h2 id="2、单例模式实现一台打印机供多人使用"><a href="#2、单例模式实现一台打印机供多人使用" class="headerlink" title="2、单例模式实现一台打印机供多人使用"></a>2、单例模式实现一台打印机供多人使用</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//打印机类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Printer</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">static</span> Printer *<span class="title">getInstance</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> Pprinter;&#125;</span><br><span class="line">	<span class="keyword">int</span> m_Print_Times;   <span class="comment">//打印次数</span></span><br><span class="line">    string m_Model;     <span class="comment">//打印机型号</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="built_in">Printer</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		m_Model=<span class="string">&quot;喵喵&quot;</span>;</span><br><span class="line">		m_Print_Times=<span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">Printer</span>(<span class="keyword">const</span> Printer&amp; printer)&#123;&#125;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">static</span> Printer *Pprinter;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Printer* Printer::Pprinter = <span class="keyword">new</span> Printer;</span><br><span class="line"><span class="comment">//Printer* printer=Printer::getInstance();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//员工类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Employee</span>(string name)</span><br><span class="line">	&#123;</span><br><span class="line">		m_Name=name;</span><br><span class="line">		printer=Printer::<span class="built_in">getInstance</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Print</span><span class="params">(string text)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot;员工：&quot;</span>&lt;&lt;m_Name&lt;&lt;<span class="string">&quot;正在使用：&quot;</span>&lt;&lt;printer-&gt;m_Model&lt;&lt;<span class="string">&quot;打印机打印：&quot;</span>&lt;&lt;text&lt;&lt;endl;</span><br><span class="line">		cout&lt;&lt;printer-&gt;m_Model&lt;&lt;<span class="string">&quot;打印机已被使用：&quot;</span>&lt;&lt;++printer-&gt;m_Print_Times&lt;&lt;<span class="string">&quot;次&quot;</span>&lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">    string m_Name;</span><br><span class="line">    Printer* printer;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Employee <span class="title">employee</span><span class="params">(<span class="string">&quot;财务小姐姐&quot;</span>)</span></span>;</span><br><span class="line">	employee.<span class="built_in">Print</span>(<span class="string">&quot;你的工资已被本仙女没收了&quot;</span>);</span><br><span class="line">	</span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;---------------------------&quot;</span>&lt;&lt;endl;</span><br><span class="line">	</span><br><span class="line">	<span class="function">Employee <span class="title">employee1</span><span class="params">(<span class="string">&quot;前台小姐姐&quot;</span>)</span></span>;</span><br><span class="line">	employee1.<span class="built_in">Print</span>(<span class="string">&quot;今晚有空有我家吗&quot;</span>); </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(employee.printer==employee1.printer)</span><br><span class="line">	&#123;</span><br><span class="line">		cout&lt;&lt;endl&lt;&lt;<span class="string">&quot;公司只有一台名为：&quot;</span>&lt;&lt;employee.printer-&gt;m_Model&lt;&lt;<span class="string">&quot;的打印机&quot;</span>&lt;&lt;endl; </span><br><span class="line">	&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smilesrx.github.io/2021/04/21/C++/C++%E7%BB%A7%E6%89%BF-%E6%B4%BE%E7%94%9F/%E7%BB%A7%E6%89%BF-%E6%B4%BE%E7%94%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CandyKing">
      <meta itemprop="description" content="虾米">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆玺之路">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/21/C++/C++%E7%BB%A7%E6%89%BF-%E6%B4%BE%E7%94%9F/%E7%BB%A7%E6%89%BF-%E6%B4%BE%E7%94%9F/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-21 20:23:45" itemprop="dateCreated datePublished" datetime="2021-04-21T20:23:45+08:00">2021-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-11-10 23:01:59" itemprop="dateModified" datetime="2020-11-10T23:01:59+08:00">2020-11-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="为什么要使用继承"><a href="#为什么要使用继承" class="headerlink" title="为什么要使用继承"></a>为什么要使用继承</h1><p>面向对象程序设计中最重要的一个概念是<strong>继承</strong></p>
<p>继承允许我们依据另一个类来定义一个类，这使得创建和维护一个应用程序变得更容易。这样做，也达到了重用代码功能和提高执行效率的效果。</p>
<p>当创建一个类时，您不需要重新编写新的数据成员和成员函数，只需指定新建的类继承了一个已有的类的成员即可。这个已有的类称为<strong>基类</strong>，新建的类称为<strong>派生类</strong>。</p>
<p>继承代表了 <strong>is a</strong> 关系。例如，哺乳动物是动物，狗是哺乳动物，因此，狗是动物，等等。</p>
<img src="/继承-派生.png" alt="继承-派生" style="zoom:80%;" />

<h1 id="继承基本概念"><a href="#继承基本概念" class="headerlink" title="继承基本概念"></a>继承基本概念</h1><p>c++最重要的特征是代码重用，通过继承机制可以利用已有的数据类型来定义新的数据类型，新的类不仅拥有旧类的成员，还拥有新定义的成员。</p>
<p>一个B类继承于A类，或称从类A派生类B。这样的话，类A成为基类（父类）， 类B成为派生类（子类）。</p>
<p>派生类中的成员，包含两大部分：</p>
<ul>
<li>一类是从基类继承过来的，一类是自己增加的成员。</li>
<li>从基类继承过过来的表现其共性，而新增的成员体现了其个性。</li>
</ul>
<h2 id="1、派生类的定义"><a href="#1、派生类的定义" class="headerlink" title="1、派生类的定义"></a>1、派生类的定义</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Class 派生类名 :  继承方式 基类名&#123;</span><br><span class="line">      <span class="comment">//派生类新增的数据成员和成员函数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2、三种继承方式"><a href="#2、三种继承方式" class="headerlink" title="2、三种继承方式"></a>2、三种继承方式</h2><ul>
<li>public：      共有继承</li>
<li>protected：保护继承</li>
<li>private：    私有继承</li>
</ul>
<p>从继承源上分：</p>
<ul>
<li>单继承：指每个派生类只直接继承了一个基类的特征</li>
<li>多继承：指多个基类派生出一个派生类的继承关系,多继承的派生类直接继承了不止一个基类的特征</li>
</ul>
<h2 id="3、派生类的访问特性"><a href="#3、派生类的访问特性" class="headerlink" title="3、派生类的访问特性"></a>3、派生类的访问特性</h2><p>派生类继承基类，派生类拥有基类中全部成员变量和成员方法（除了构造和析构之外的成员方法），但是在派生类中，继承的成员并不一定能直接访问，不同的继承方式会导致不同的访问权限。</p>
<p>派生类的访问权限规则如下：</p>
<table>
<thead>
<tr>
<th></th>
<th>共有继承public</th>
<th>保护继承protected</th>
<th>私有继承private</th>
</tr>
</thead>
<tbody><tr>
<td>基类成员属性</td>
<td>派生类成员属性</td>
<td>派生类成员属性</td>
<td>派生类成员属性</td>
</tr>
<tr>
<td>public</td>
<td>public</td>
<td>protected</td>
<td>private</td>
</tr>
<tr>
<td>protected</td>
<td>protected</td>
<td>protected</td>
<td>private</td>
</tr>
<tr>
<td>private</td>
<td>不可访问</td>
<td>不可访问</td>
<td>不可访问</td>
</tr>
</tbody></table>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//基类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">int</span> mA;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="keyword">int</span> mB;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> mC;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//1. 公有(public)继承</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> :</span> <span class="keyword">public</span> A&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">PrintB</span><span class="params">()</span></span>&#123;</span><br><span class="line">		cout &lt;&lt; mA &lt;&lt; endl; <span class="comment">//可访问基类public属性</span></span><br><span class="line">		cout &lt;&lt; mB &lt;&lt; endl; <span class="comment">//可访问基类protected属性</span></span><br><span class="line">		<span class="comment">//cout &lt;&lt; mC &lt;&lt; endl; //不可访问基类private属性</span></span><br><span class="line">	&#125;  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SubB</span> :</span> <span class="keyword">public</span> B&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">PrintSubB</span><span class="params">()</span></span>&#123;</span><br><span class="line">		cout &lt;&lt; mA &lt;&lt; endl; <span class="comment">//可访问基类public属性</span></span><br><span class="line">		cout &lt;&lt; mB &lt;&lt; endl; <span class="comment">//可访问基类protected属性</span></span><br><span class="line">		<span class="comment">//cout &lt;&lt; mC &lt;&lt; endl; //不可访问基类private属性</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	B b;</span><br><span class="line">	cout &lt;&lt; b.mA &lt;&lt; endl; <span class="comment">//可访问基类public属性</span></span><br><span class="line">	<span class="comment">//cout &lt;&lt; b.mB &lt;&lt; endl; //不可访问基类protected属性</span></span><br><span class="line">	<span class="comment">//cout &lt;&lt; b.mC &lt;&lt; endl; //不可访问基类private属性</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2. 私有(private)继承</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> :</span> <span class="keyword">private</span> A&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">PrintC</span><span class="params">()</span></span>&#123;</span><br><span class="line">		cout &lt;&lt; mA &lt;&lt; endl; <span class="comment">//可访问基类public属性</span></span><br><span class="line">		cout &lt;&lt; mB &lt;&lt; endl; <span class="comment">//可访问基类protected属性</span></span><br><span class="line">		<span class="comment">//cout &lt;&lt; mC &lt;&lt; endl; //不可访问基类private属性</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SubC</span> :</span> <span class="keyword">public</span> C&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">PrintSubC</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">//cout &lt;&lt; mA &lt;&lt; endl; //不可访问基类public属性</span></span><br><span class="line">		<span class="comment">//cout &lt;&lt; mB &lt;&lt; endl; //不可访问基类protected属性</span></span><br><span class="line">		<span class="comment">//cout &lt;&lt; mC &lt;&lt; endl; //不可访问基类private属性</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test02</span><span class="params">()</span></span>&#123;</span><br><span class="line">	C c;</span><br><span class="line">	<span class="comment">//cout &lt;&lt; c.mA &lt;&lt; endl; //不可访问基类public属性</span></span><br><span class="line">	<span class="comment">//cout &lt;&lt; c.mB &lt;&lt; endl; //不可访问基类protected属性</span></span><br><span class="line">	<span class="comment">//cout &lt;&lt; c.mC &lt;&lt; endl; //不可访问基类private属性</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//3. 保护(protected)继承</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span> :</span> <span class="keyword">protected</span> A&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">PrintD</span><span class="params">()</span></span>&#123;</span><br><span class="line">		cout &lt;&lt; mA &lt;&lt; endl; <span class="comment">//可访问基类public属性</span></span><br><span class="line">		cout &lt;&lt; mB &lt;&lt; endl; <span class="comment">//可访问基类protected属性</span></span><br><span class="line">		<span class="comment">//cout &lt;&lt; mC &lt;&lt; endl; //不可访问基类private属性</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SubD</span> :</span> <span class="keyword">public</span> D&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">PrintD</span><span class="params">()</span></span>&#123;</span><br><span class="line">		cout &lt;&lt; mA &lt;&lt; endl; <span class="comment">//可访问基类public属性</span></span><br><span class="line">		cout &lt;&lt; mB &lt;&lt; endl; <span class="comment">//可访问基类protected属性</span></span><br><span class="line">		<span class="comment">//cout &lt;&lt; mC &lt;&lt; endl; //不可访问基类private属性</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test03</span><span class="params">()</span></span>&#123;</span><br><span class="line">	D d;</span><br><span class="line">	<span class="comment">//cout &lt;&lt; d.mA &lt;&lt; endl; //不可访问基类public属性</span></span><br><span class="line">	<span class="comment">//cout &lt;&lt; d.mB &lt;&lt; endl; //不可访问基类protected属性</span></span><br><span class="line">	<span class="comment">//cout &lt;&lt; d.mC &lt;&lt; endl; //不可访问基类private属性</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="继承中的对象模型"><a href="#继承中的对象模型" class="headerlink" title="继承中的对象模型"></a>继承中的对象模型</h1><p>父类中的私有属性，子类是继承下去了，只不过由编译器给隐藏了，访问不到</p>
<p>在C++编译器的内部可以理解为结构体，子类是由父类成员叠加子类新成员而成：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Aclass</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">int</span> mA;</span><br><span class="line">	<span class="keyword">int</span> mB;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bclass</span> :</span> <span class="keyword">public</span> Aclass&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">int</span> mC;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cclass</span> :</span> <span class="keyword">public</span> Bclass&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">int</span> mD;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;A size:&quot;</span> &lt;&lt; <span class="built_in"><span class="keyword">sizeof</span></span>(Aclass) &lt;&lt; endl;    <span class="comment">//8</span></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;B size:&quot;</span> &lt;&lt; <span class="built_in"><span class="keyword">sizeof</span></span>(Bclass) &lt;&lt; endl;    <span class="comment">//12</span></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;C size:&quot;</span> &lt;&lt; <span class="built_in"><span class="keyword">sizeof</span></span>(Cclass) &lt;&lt; endl;    <span class="comment">//16</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>利用开发人员工具查看对象模型:</p>
<ul>
<li><code>C:\Program Files (x86)\Microsoft Visual Studio 12.0\Common7\Tools\Shortcuts</code></li>
<li>打开开发人员命令工具</li>
<li>跳转盘符 E:</li>
<li>跳转文件路径  cd到文件路径下</li>
<li><code>cl d1 reportSingleClassLayout类名  文件名</code></li>
</ul>
<h1 id="对象构造和析构的调用规则"><a href="#对象构造和析构的调用规则" class="headerlink" title="对象构造和析构的调用规则"></a>对象构造和析构的调用规则</h1><h2 id="1、继承中的构造和析构"><a href="#1、继承中的构造和析构" class="headerlink" title="1、继承中的构造和析构"></a>1、继承中的构造和析构</h2><ul>
<li><p>先调用父类构造，再调用其他成员构造， 再调用自身构造 </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base1</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Base1</span>()&#123;cout &lt;&lt; <span class="string">&quot;Base1的构造函数调用&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="built_in">Base1</span>()&#123;cout &lt;&lt; <span class="string">&quot;Base1的析构函数调用&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Other</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Other</span>()&#123;cout &lt;&lt; <span class="string">&quot;Other的构造函数调用&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="built_in">Other</span>()&#123;cout &lt;&lt; <span class="string">&quot;Other的析构函数调用&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son1</span> :</span><span class="keyword">public</span> Base1&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Son1</span>()&#123;cout &lt;&lt; <span class="string">&quot;Son1的构造函数调用&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="built_in">Son1</span>()&#123;cout &lt;&lt; <span class="string">&quot;Son1的析构函数调用&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line"></span><br><span class="line">	Other other;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span>&#123;</span><br><span class="line">	Son1 s; <span class="comment">//先调用父类构造，再调用其他成员构造， 再调用自身构造 ，析构的顺序与构造相反</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Base1的构造函数调用</span></span><br><span class="line"><span class="comment">Other的构造函数调用</span></span><br><span class="line"><span class="comment">Son1的构造函数调用</span></span><br><span class="line"><span class="comment">Son1的析构函数调用</span></span><br><span class="line"><span class="comment">Other的析构函数调用</span></span><br><span class="line"><span class="comment">Base1的析构函数调用</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></li>
<li><p>当父类构造函数有参数时，需要在子类初始化列表(参数列表)中显示调用父类构造函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base2</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Base2</span>(<span class="keyword">int</span> a)&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;m_A = a;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Base2的构造函数调用&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> m_A;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son2</span> :</span><span class="keyword">public</span> Base2&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Son2</span>(<span class="keyword">int</span> a = <span class="number">1000</span> ) :<span class="built_in">Base2</span>(a)  <span class="comment">//利用初始化列表语法  显示调用父类中的其他构造函数</span></span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Son2的构造函数调用&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test02</span><span class="params">()</span></span>&#123;</span><br><span class="line">	Son2 s;</span><br><span class="line">	cout &lt;&lt; s.m_A &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Base2的构造函数调用</span></span><br><span class="line"><span class="comment">Son2的构造函数调用</span></span><br><span class="line"><span class="comment">1000</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></li>
<li><p>析构函数调用顺序和构造函数相反</p>
</li>
<li><p>父类中 构造、析构、拷贝构造 、operator=  是不会被子类继承下去的</p>
</li>
</ul>
<img src="/构造-析构.png" alt="构造-析构" style="zoom:60%;" />

<h2 id="2、继承中同名成员的处理方法"><a href="#2、继承中同名成员的处理方法" class="headerlink" title="2、继承中同名成员的处理方法"></a>2、继承中同名成员的处理方法</h2><ul>
<li><p>当子类成员和父类成员同名时，子类依然从父类继承同名成员</p>
</li>
<li><p>如果子类有成员和父类同名，子类访问其成员默认访问子类的成员(本作用域，就近原则)</p>
</li>
<li><p>在子类通过作用域::进行同名成员区分(在派生类中使用基类的同名成员，显示使用类名限定符)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Base</span>()&#123;<span class="keyword">this</span>-&gt;m_A = <span class="number">10</span>;&#125;</span><br><span class="line">	<span class="keyword">int</span> m_A;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son</span> :</span><span class="keyword">public</span> Base&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Son</span>()&#123;<span class="keyword">this</span>-&gt;m_A = <span class="number">20</span>;&#125;</span><br><span class="line">	<span class="keyword">int</span> m_A;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span>&#123;</span><br><span class="line">	Son s1;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;s1.m_A = &quot;</span> &lt;&lt;  s1.m_A &lt;&lt; endl;</span><br><span class="line">	<span class="comment">//我们可以利用作用域 访问父类中的同名成员</span></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Base中的m_A = &quot;</span> &lt;&lt; s1.Base::m_A &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">s1.m_A = 20</span></span><br><span class="line"><span class="comment">Base中的m_A = 10</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></li>
<li><p>当子类重新定义了父类中的同名成员函数，子类的成员函数会 隐藏掉父类中所有重载版本的同名成员，可以利用作用域显示指定调用</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Base</span>()&#123;<span class="keyword">this</span>-&gt;m_A = <span class="number">10</span>;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span>&#123;cout &lt;&lt; <span class="string">&quot;Base中的func调用&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123;cout &lt;&lt; <span class="string">&quot;Base中的func(int)调用&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line">    <span class="keyword">int</span> m_A;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son</span> :</span><span class="keyword">public</span> Base&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Son</span>()&#123;<span class="keyword">this</span>-&gt;m_A = <span class="number">20</span>;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span>&#123;cout &lt;&lt; <span class="string">&quot;Son中的func调用&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line">	<span class="keyword">int</span> m_A;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span>&#123;</span><br><span class="line">	Son s1;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;s1.m_A = &quot;</span> &lt;&lt;  s1.m_A &lt;&lt; endl;</span><br><span class="line">	<span class="comment">//我们可以利用作用域 访问父类中的同名成员</span></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Base中的m_A = &quot;</span> &lt;&lt; s1.Base::m_A &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test02</span><span class="params">()</span></span>&#123;</span><br><span class="line">	Son s1;</span><br><span class="line">	s1.<span class="built_in">func</span>();</span><br><span class="line">	s1.Base::<span class="built_in">func</span>(<span class="number">10</span>);</span><br><span class="line"><span class="comment">//当子类重新定义了父类中的同名成员函数，子类的成员函数会隐藏掉父类中所有重载版本的同名成员，可以利用作用域显示指定调用</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Son中的func调用</span></span><br><span class="line"><span class="comment">Base中的func(int)调用</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="3、继承中同名静态成员的处理方法"><a href="#3、继承中同名静态成员的处理方法" class="headerlink" title="3、继承中同名静态成员的处理方法"></a>3、继承中同名静态成员的处理方法</h2><p>静态成员函数和非静态成员函数的共同点:</p>
<ul>
<li><p>他们都可以被继承到派生类中。</p>
</li>
<li><p>如果重新定义一个静态成员函数，所有在基类中的其他重载函数会被隐藏。</p>
</li>
<li><p>如果我们改变基类中一个函数的特征，所有使用该函数名的基类版本都会被隐藏。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getNum</span><span class="params">()</span></span>&#123; <span class="keyword">return</span> sNum; &#125;</span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getNum</span><span class="params">(<span class="keyword">int</span> param)</span></span>&#123;</span><br><span class="line">		cout&lt;&lt;sNum + param&lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">int</span> sNum;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> Base::sNum = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">int</span> sNum; <span class="comment">//基类静态成员属性将被隐藏</span></span><br><span class="line">	<span class="comment">//重定义一个函数，基类中重载的函数被隐藏</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> 1</span></span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getNum</span><span class="params">(<span class="keyword">int</span> param1, <span class="keyword">int</span> param2)</span></span>&#123;</span><br><span class="line">		cout&lt;&lt;sNum + param1 + param2&lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">	<span class="comment">//改变基类函数的某个特征，返回值或者参数个数，将会隐藏基类重载的函数</span></span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">getNum</span><span class="params">(<span class="keyword">int</span> param1, <span class="keyword">int</span> param2)</span></span>&#123;</span><br><span class="line">		cout &lt;&lt;  sNum + param1 + param2 &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> Derived::sNum = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">	Derived A;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//1.通过对象访问 </span></span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;Derived::sNum=&quot;</span>&lt;&lt;A.sNum&lt;&lt;endl;</span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;Base::sNum=&quot;</span>&lt;&lt;A.Base::sNum&lt;&lt;endl;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//2.通过类名访问</span></span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;Derived::sNum=&quot;</span>&lt;&lt;Derived::sNum&lt;&lt;endl; </span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;Base::sNum=&quot;</span>&lt;&lt;Base::sNum&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span>&#123;</span><br><span class="line">	Derived A;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//1.通过对象访问 </span></span><br><span class="line">	A.<span class="built_in">getNum</span>(<span class="number">5</span>,<span class="number">6</span>);</span><br><span class="line">	A.Base::<span class="built_in">getNum</span>(<span class="number">5</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//2.通过类名访问</span></span><br><span class="line">	Derived::<span class="built_in">getNum</span>(<span class="number">5</span>,<span class="number">6</span>);</span><br><span class="line">	Derived::Base::<span class="built_in">getNum</span>(<span class="number">5</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="多继承"><a href="#多继承" class="headerlink" title="多继承"></a>多继承</h1><h2 id="1、多继承的概念"><a href="#1、多继承的概念" class="headerlink" title="1、多继承的概念"></a>1、多继承的概念</h2><p>我们可以从一个类继承，我们也可以能同时从多个类继承，这就是多继承。但是由于多继承是非常受争议的，从多个类继承可能会导致函数、变量等同名导致较多的歧义。</p>
<p><img src="/%E5%A4%9A%E7%BB%A7%E6%89%BF.png" alt="多继承"></p>
<p>基本语法：<code>class 子类 ： 继承方式  父类1 ， 继承方式 父类2</code></p>
<p>当多继承的两个父类中有同名成员，需要加作用域区分</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base1</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Base1</span>()&#123;<span class="keyword">this</span>-&gt;m_A = <span class="number">10</span>;&#125;</span><br><span class="line">	<span class="keyword">int</span> m_A;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base2</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Base2</span>()&#123;<span class="keyword">this</span>-&gt;m_A = <span class="number">20</span>;&#125;</span><br><span class="line">	<span class="keyword">int</span> m_A;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//多继承</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son</span> :</span> <span class="keyword">public</span> Base1, <span class="keyword">public</span> Base2&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">int</span> m_C;</span><br><span class="line">	<span class="keyword">int</span> m_D;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;sizeof Son = &quot;</span> &lt;&lt; <span class="built_in"><span class="keyword">sizeof</span></span>(Son) &lt;&lt; endl;    <span class="comment">//16</span></span><br><span class="line">	Son s;</span><br><span class="line">	<span class="comment">//当多继承的两个父类中有同名成员，需要加作用域区分</span></span><br><span class="line">	cout &lt;&lt; s.Base1::m_A &lt;&lt; endl;    <span class="comment">//10</span></span><br><span class="line">	cout &lt;&lt; s.Base2::m_A &lt;&lt; endl;    <span class="comment">//20</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base1</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span></span>&#123; cout &lt;&lt; <span class="string">&quot;Base1::func1&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base2</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span></span>&#123; cout &lt;&lt; <span class="string">&quot;Base2::func1&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func2</span><span class="params">()</span></span>&#123; cout &lt;&lt; <span class="string">&quot;Base2::func2&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//派生类继承Base1、Base2</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base1, <span class="keyword">public</span> Base2&#123;&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	Derived derived;</span><br><span class="line">	<span class="comment">//func1是从Base1继承来的还是从Base2继承来的？</span></span><br><span class="line">	<span class="comment">//derived.func1(); </span></span><br><span class="line">	derived.<span class="built_in">func2</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">//解决歧义:显示指定调用那个基类的func1</span></span><br><span class="line">	derived.Base1::<span class="built_in">func1</span>(); </span><br><span class="line">	derived.Base2::<span class="built_in">func1</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多继承会带来一些二义性的问题， 如果两个基类中有同名的函数或者变量，那么通过派生类对象去访问这个函数或变量时就不能明确到底调用从基类1继承的版本还是从基类2继承的版本？</p>
<p>解决方法就是显示指定调用那个基类的版本。</p>
<h1 id="菱形继承和虚继承"><a href="#菱形继承和虚继承" class="headerlink" title="菱形继承和虚继承"></a>菱形继承和虚继承</h1><p>两个派生类继承同一个基类而又有某个类同时继承着两个派生类，这种继承被称为菱形继承，或者钻石型继承。</p>
<img src="/菱形继承.png" alt="菱形继承" style="zoom:75%;" />

<p>这种继承所带来的问题：</p>
<ul>
<li>羊继承了动物的数据和函数，鸵同样继承了动物的数据和函数，当草泥马调用函数或者数据时，就会产生二义性。</li>
<li>草泥马继承自动物的函数和数据继承了两份，其实我们应该清楚，这份数据我们只需要一份就可以。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BigBase</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">BigBase</span>()&#123; mParam = <span class="number">0</span>; &#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span>&#123; cout &lt;&lt; <span class="string">&quot;BigBase::func&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">int</span> mParam;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base1</span> :</span> <span class="keyword">public</span> BigBase&#123;&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base2</span> :</span> <span class="keyword">public</span> BigBase&#123;&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base1, <span class="keyword">public</span> Base2&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	Derived derived;</span><br><span class="line">	<span class="comment">//1. 对“func”的访问不明确</span></span><br><span class="line">	<span class="comment">//derived.func();</span></span><br><span class="line">	<span class="comment">//cout &lt;&lt; derived.mParam &lt;&lt; endl;</span></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;derived.Base1::mParam:&quot;</span> &lt;&lt; derived.Base1::mParam &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;derived.Base2::mParam:&quot;</span> &lt;&lt; derived.Base2::mParam &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//2. 重复继承</span></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Derived size:&quot;</span> &lt;&lt; <span class="built_in"><span class="keyword">sizeof</span></span>(Derived) &lt;&lt; endl; <span class="comment">//8</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上述问题如何解决？对于调用二义性，那么可通过指定调用那个基类的方式来解决，那么重复继承怎么解决？</p>
<p>对于这种菱形继承所带来的两个问题，c++为我们提供了一种方式，采用虚基类。那么我们采用虚基类方式将代码修改如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BigBase</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">BigBase</span>()&#123; mParam = <span class="number">0</span>; &#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span>&#123; cout &lt;&lt; <span class="string">&quot;BigBase::func&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">int</span> mParam;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base1</span> :</span> <span class="keyword">virtual</span> <span class="keyword">public</span> BigBase&#123;&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base2</span> :</span> <span class="keyword">virtual</span> <span class="keyword">public</span> BigBase&#123;&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base1, <span class="keyword">public</span> Base2&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	Derived derived;</span><br><span class="line">	<span class="comment">//二义性问题解决</span></span><br><span class="line">	derived.<span class="built_in">func</span>();</span><br><span class="line">	cout &lt;&lt; derived.mParam &lt;&lt; endl;</span><br><span class="line">	<span class="comment">//输出结果:24</span></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Derived size:&quot;</span> &lt;&lt; <span class="built_in"><span class="keyword">sizeof</span></span>(Derived) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上程序Base1 ，Base2采用虚继承方式继承BigBase,那么BigBase被称为虚基类。</p>
<p>通过虚继承解决了菱形继承所带来的二义性问题。</p>
<p>但是虚基类是如何解决二义性的呢？并且derived大小为24字节，这是怎么回事？</p>
<h2 id="1、虚继承实现原理"><a href="#1、虚继承实现原理" class="headerlink" title="1、虚继承实现原理"></a>1、虚继承实现原理</h2><p><img src="/%E8%99%9A%E7%BB%A7%E6%89%BF.png" alt="虚继承"></p>
<p>通过内存图，我们发现普通继承和虚继承的对象内存图是不一样的。我们也可以猜测到编译器肯定对我们编写的程序做了一些手脚</p>
<ul>
<li><code>BigBase</code> 菱形最顶层的类，内存布局图没有发生改变</li>
<li><code>Base1</code>和<code>Base2</code>通过虚继承的方式派生自<code>BigBase</code>,这两个对象的布局图中可以看出编译器为我们的对象中增加了一个<code>vbptr</code> (virtual base pointer),<code>vbptr</code>指向了一张表，这张表保存了当前的虚指针相对于虚基类的首地址的偏移量。</li>
<li>Derived派生于<code>Base1</code>和<code>Base2</code>,继承了两个基类的<code>vbptr</code>指针，并调整了<code>vbptr</code>与虚基类的首地址的偏移量。</li>
</ul>
<p>Derived派生于<code>Base1</code>和<code>Base2</code>,继承了两个基类的<code>vbptr</code>指针，并调整了<code>vbptr</code>与虚基类的首地址的偏移量。</p>
<p>当使用虚继承时，虚基类是被共享的，也就是在继承体系中无论被继承多少次，对象内存模型中均只会出现一个虚基类的子对象（这和多继承是完全不同的）。即使共享虚基类，但是必须要有一个类来完成基类的初始化（因为所有的对象都必须被初始化，哪怕是默认的），同时还不能够重复进行初始化，那到底谁应该负责完成初始化呢？C++标准中选择在每一次继承子类中都必须书写初始化语句（因为每一次继承子类可能都会用来定义对象），但是虚基类的初始化是由最后的子类完成，其他的初始化语句都不会调用。</p>
<p>注意： 虚继承只能解决具备公共祖先的多继承所带来的二义性问题，不能解决没有公共祖先的多继承的.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smilesrx.github.io/2021/04/21/C++/C++%E5%87%BD%E6%95%B0%E6%A8%A1%E6%9D%BF%E5%AE%9E%E7%8E%B0int%E3%80%81char%E7%B1%BB%E5%9E%8B%E6%95%B0%E7%BB%84%E6%8E%92%E5%BA%8F/%E5%87%BD%E6%95%B0%E6%A8%A1%E6%9D%BF%E5%AE%9E%E7%8E%B0int%E3%80%81char%E7%B1%BB%E5%9E%8B%E6%95%B0%E7%BB%84%E6%8E%92%E5%BA%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CandyKing">
      <meta itemprop="description" content="虾米">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆玺之路">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/21/C++/C++%E5%87%BD%E6%95%B0%E6%A8%A1%E6%9D%BF%E5%AE%9E%E7%8E%B0int%E3%80%81char%E7%B1%BB%E5%9E%8B%E6%95%B0%E7%BB%84%E6%8E%92%E5%BA%8F/%E5%87%BD%E6%95%B0%E6%A8%A1%E6%9D%BF%E5%AE%9E%E7%8E%B0int%E3%80%81char%E7%B1%BB%E5%9E%8B%E6%95%B0%E7%BB%84%E6%8E%92%E5%BA%8F/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-21 20:23:45" itemprop="dateCreated datePublished" datetime="2021-04-21T20:23:45+08:00">2021-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-20 21:33:13" itemprop="dateModified" datetime="2020-10-20T21:33:13+08:00">2020-10-20</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="函数模板实现int、char类型数组排序"><a href="#函数模板实现int、char类型数组排序" class="headerlink" title="函数模板实现int、char类型数组排序"></a>函数模板实现int、char类型数组排序</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Swap</span><span class="params">(T &amp;a,T &amp;b)</span>   <span class="comment">//交换</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	T tmp=a;</span><br><span class="line">	a=b;</span><br><span class="line">	b=tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;  <span class="comment">//选择排序</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Sort</span><span class="params">(T arr,<span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> max=i;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;len;++j)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(arr[max]&lt;arr[j])</span><br><span class="line">				max=j;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(max!=<span class="number">1</span>)</span><br><span class="line">			<span class="built_in">Swap</span>(arr[i],arr[max]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span>    <span class="comment">//打印</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Print</span><span class="params">(T arr,<span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;arr[i]; </span><br><span class="line">	&#125;</span><br><span class="line">	cout&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> IntArr[]=&#123;<span class="number">5</span>,<span class="number">2</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">7</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> len=<span class="built_in"><span class="keyword">sizeof</span></span>(IntArr)/<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>);</span><br><span class="line">	<span class="built_in">Sort</span>(IntArr,len);</span><br><span class="line">	<span class="built_in">Print</span>(IntArr,len);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">char</span> CharArr[]=<span class="string">&quot;helloworld&quot;</span>;</span><br><span class="line">	len=<span class="built_in">strlen</span>(CharArr);</span><br><span class="line">	<span class="built_in">Sort</span>(CharArr,len);</span><br><span class="line">	<span class="built_in">Print</span>(CharArr,len);		</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smilesrx.github.io/2021/04/21/C++/C++%E5%87%BD%E6%95%B0%E7%9A%84%E9%BB%98%E8%AE%A4%E5%8F%82%E6%95%B0%E5%92%8C%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD/C++%E5%87%BD%E6%95%B0%E7%9A%84%E9%BB%98%E8%AE%A4%E5%8F%82%E6%95%B0%E5%92%8C%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CandyKing">
      <meta itemprop="description" content="虾米">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆玺之路">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/21/C++/C++%E5%87%BD%E6%95%B0%E7%9A%84%E9%BB%98%E8%AE%A4%E5%8F%82%E6%95%B0%E5%92%8C%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD/C++%E5%87%BD%E6%95%B0%E7%9A%84%E9%BB%98%E8%AE%A4%E5%8F%82%E6%95%B0%E5%92%8C%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-21 20:23:45" itemprop="dateCreated datePublished" datetime="2021-04-21T20:23:45+08:00">2021-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-11 13:21:16" itemprop="dateModified" datetime="2020-10-11T13:21:16+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="函数的默认参数"><a href="#函数的默认参数" class="headerlink" title="函数的默认参数"></a>函数的默认参数</h1><p>c++在声明函数原型的时可为一个或者多个参数指定默认(缺省)的参数值，当函数调用的时候如果没有指定这个值，编译器会自动用默认值代替。</p>
<p>注意：</p>
<ul>
<li>函数的默认参数是从左至右的，如果某一位置的参数设置了默认参数，那么该参数之后的参数都必须设置默认参数</li>
<li>如果函数申明和定义是分开的，那么申明和定义不能同时设置默认参数</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">funcA</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;funcA函数调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;a=&quot;</span>&lt;&lt;a&lt;&lt;<span class="string">&quot;  b=&quot;</span>&lt;&lt;b&lt;&lt;<span class="string">&quot;  c=&quot;</span>&lt;&lt;c&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">funcB</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b=<span class="number">5</span>,<span class="keyword">int</span> c=<span class="number">10</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;funcB函数调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;a=&quot;</span>&lt;&lt;a&lt;&lt;<span class="string">&quot;  b=&quot;</span>&lt;&lt;b&lt;&lt;<span class="string">&quot;  c=&quot;</span>&lt;&lt;c&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">funcC</span><span class="params">(<span class="keyword">int</span> a=<span class="number">5</span>,<span class="keyword">int</span> b=<span class="number">15</span>,<span class="keyword">int</span> c=<span class="number">20</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;funC函数调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;a=&quot;</span>&lt;&lt;a&lt;&lt;<span class="string">&quot;  b=&quot;</span>&lt;&lt;b&lt;&lt;<span class="string">&quot;  c=&quot;</span>&lt;&lt;c&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> b=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">int</span> c=<span class="number">3</span>;</span><br><span class="line">    <span class="built_in">funcA</span>(a,b,c);   <span class="comment">//结果：a=1  b=2  c=3 </span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">funcB</span>(a,b,c);   <span class="comment">//结果：a=1  b=2  c=3 </span></span><br><span class="line">    <span class="built_in">funcB</span>(a,b);     <span class="comment">//结果：a=1  b=2  c=10 </span></span><br><span class="line">    <span class="built_in">funcB</span>(a);       <span class="comment">//结果：a=1  b=5  c=10 </span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">funcC</span>();        <span class="comment">//结果：a=5  b=15  c=20   </span></span><br><span class="line">    <span class="built_in">funcC</span>(a);       <span class="comment">//结果：a=1  b=15  c=20   </span></span><br><span class="line">    <span class="built_in">funcC</span>(a,b);     <span class="comment">//结果：a=1  b=2  c=20  </span></span><br><span class="line">    <span class="built_in">funcC</span>(a,b,c);   <span class="comment">//结果：a=1  b=2  c=3 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="函数的占位参数"><a href="#函数的占位参数" class="headerlink" title="函数的占位参数"></a>函数的占位参数</h1><ul>
<li><p>c++在声明和定义函数时，可以设置占位参数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//申明</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span>)</span></span>;</span><br><span class="line"><span class="comment">//实现</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;a+b=&quot;</span>&lt;&lt;a+b&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>占位参数只有参数类型声明，而没有参数名声明。</p>
</li>
<li><p>一般情况下，在函数体内部无法使用占位参数。</p>
</li>
<li><p>占位参数也可以设置默认值</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> a=<span class="number">5</span>,<span class="keyword">int</span> b=<span class="number">10</span>,<span class="keyword">int</span>=<span class="number">15</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   cout&lt;&lt;<span class="string">&quot;a+b=&quot;</span>&lt;&lt;a+b&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>占位参数也是参数调用时如未设置默认参数必须传占位参数的值</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;a+b=&quot;</span>&lt;&lt;a+b&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">func</span>(<span class="number">5</span>,<span class="number">10</span>,<span class="number">15</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="函数重载"><a href="#函数重载" class="headerlink" title="函数重载"></a>函数重载</h1><p>条件：</p>
<ol>
<li><p>作用域相同</p>
</li>
<li><p>函数名相同</p>
</li>
<li><p>参数表不同（参数类型、参数个数、参数顺序）</p>
</li>
<li><p>参数加<code>const</code>和不加<code>const</code>的引用也能做重载条件</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;常引用下a=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> &amp;a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;一般引用下a=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a=<span class="number">10</span>;</span><br><span class="line">    <span class="built_in">func</span>(a);    <span class="comment">//结果：一般引用下a=10</span></span><br><span class="line">    <span class="built_in">func</span>(<span class="number">5</span>);    <span class="comment">//结果：常引用下a=5</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>返回值类型不做重载条件</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span>&#123;cout&lt;&lt;<span class="string">&quot;func无参函数调用&quot;</span>&lt;&lt;endl;&#125;</span><br><span class="line"><span class="comment">//int func()&#123;cout&lt;&lt;&quot;func无参函数调用&quot;&lt;&lt;endl;rerurn 0;&#125;   //返回值类型不做重载条件</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123;cout&lt;&lt;<span class="string">&quot;a=&quot;</span>&lt;&lt;a&lt;&lt;endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(string str)</span></span>&#123;cout&lt;&lt;<span class="string">&quot;str=&quot;</span>&lt;&lt;str&lt;&lt;endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> a,string str)</span></span>&#123;cout&lt;&lt;<span class="string">&quot;a=&quot;</span>&lt;&lt;a&lt;&lt;<span class="string">&quot;  str=&quot;</span>&lt;&lt;str&lt;&lt;endl;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(string str,<span class="keyword">int</span> a)</span></span>&#123;cout&lt;&lt;<span class="string">&quot;str=&quot;</span>&lt;&lt;str&lt;&lt;<span class="string">&quot;  a=&quot;</span>&lt;&lt;a&lt;&lt;endl;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">func</span>();           <span class="comment">//结果：func无参函数调用  </span></span><br><span class="line">    <span class="built_in">func</span>(<span class="number">5</span>);           <span class="comment">//结果：a=5  </span></span><br><span class="line">    <span class="built_in">func</span>(<span class="string">&quot;hello&quot;</span>);     <span class="comment">//结果：str=hello  </span></span><br><span class="line">    <span class="built_in">func</span>(<span class="number">5</span>,<span class="string">&quot;hello&quot;</span>);   <span class="comment">//结果：a=5  str=hello </span></span><br><span class="line">    <span class="built_in">func</span>(<span class="string">&quot;hello&quot;</span>,<span class="number">5</span>);   <span class="comment">//结果：str=hello  a=5 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="函数重载碰到默认参数"><a href="#函数重载碰到默认参数" class="headerlink" title="函数重载碰到默认参数"></a>函数重载碰到默认参数</h1><p>注意：切记避免二义性</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> a=<span class="number">5</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;a=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;我就是个坑，而你非要跳进来&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">func</span>();    <span class="comment">//调用时两个函数都能匹配不知道调用哪一个（产生二义性）</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="extern-“C”"><a href="#extern-“C”" class="headerlink" title="extern “C”"></a>extern “C”</h1><p>由于c++中需要支持函数重载，所以c和c++中对同一个函数经过编译后生成的函数名是不相同的，这就导致了一个问题，如果在c++中调用一个使用c语言编写模块中的某个函数，那么c++是根据c++的名称修饰方式来查找并链接这个函数，那么就会发生链接错误(找不到这个函数)</p>
<p>用途：在C++中调用C语言文件</p>
<p>解决方法：</p>
<ul>
<li><p>在C++文件中加<code>extern &quot;C&quot; void show();</code>告诉编译器  show函数按c语言的方式进行<strong>编译</strong>和<strong>链接</strong>，而不是按c++的方式</p>
</li>
<li><p>在C语言头文件中加</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">if</span> __cplusplus</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    </span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> __cplusplus</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smilesrx.github.io/2021/04/21/C++/C++%E6%9E%84%E9%80%A0%E5%92%8C%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0/C++%E6%9E%84%E9%80%A0%E5%92%8C%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CandyKing">
      <meta itemprop="description" content="虾米">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆玺之路">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/21/C++/C++%E6%9E%84%E9%80%A0%E5%92%8C%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0/C++%E6%9E%84%E9%80%A0%E5%92%8C%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-21 20:23:45" itemprop="dateCreated datePublished" datetime="2021-04-21T20:23:45+08:00">2021-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-12 21:43:09" itemprop="dateModified" datetime="2020-10-12T21:43:09+08:00">2020-10-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h1><p>构造函数主要作用在于创建对象时为对象的成员属性赋值，构造函数由编译器自动调用，无须手动调用。</p>
<h2 id="1、构造函数语法"><a href="#1、构造函数语法" class="headerlink" title="1、构造函数语法"></a>1、构造函数语法</h2><ul>
<li><p>构造函数没有返回值，不能用void</p>
</li>
<li><p>构造函数名和类名相同</p>
</li>
<li><p>构造可以有参数</p>
</li>
<li><p>构造可以重载</p>
</li>
<li><p><code>classname()&#123; &#125;</code></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Person</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;构造函数调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">        pName=(<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="number">20</span>);</span><br><span class="line">        <span class="built_in">strcpy</span>(pName,<span class="string">&quot;老王&quot;</span>); </span><br><span class="line">        m_Tall=<span class="number">180</span>;</span><br><span class="line">        m_Money=<span class="number">100000</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ~<span class="built_in">Person</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;析构函数调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">if</span>(pName)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">free</span>(pName);</span><br><span class="line">            pName=<span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">char</span>* pName;</span><br><span class="line">	<span class="keyword">int</span> m_Tall;</span><br><span class="line">	<span class="keyword">int</span> m_Money;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Person person;   <span class="comment">//结果：构造函数调用 </span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;person.pName&lt;&lt;<span class="string">&quot;  身高：&quot;</span>&lt;&lt;person.m_Tall&lt;&lt;<span class="string">&quot;  身家：&quot;</span>&lt;&lt;person.m_Money&lt;&lt;endl;</span><br><span class="line">                     <span class="comment">//结果：姓名：老王  身高：180  身家：100000  </span></span><br><span class="line">                     <span class="comment">//结果：析构函数调用</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="2、构造函数的分类及调用"><a href="#2、构造函数的分类及调用" class="headerlink" title="2、构造函数的分类及调用"></a>2、构造函数的分类及调用</h2><h3 id="1、分类"><a href="#1、分类" class="headerlink" title="1、分类"></a>1、分类</h3><ul>
<li><p>按参数类型：分为无参构造函数和有参构造函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Person</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot;无参构造函数调用&quot;</span>&lt;&lt;endl; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">Person</span>(string name,<span class="keyword">int</span> tall,<span class="keyword">int</span> money)</span><br><span class="line">	&#123;</span><br><span class="line">		m_Name=name;</span><br><span class="line">		m_Tall=tall;</span><br><span class="line">		m_Money=money;</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot;有参构造函数调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	string m_Name;</span><br><span class="line">	<span class="keyword">int</span> m_Tall;</span><br><span class="line">	<span class="keyword">int</span> m_Money;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Person person;         <span class="comment">//结果：构造函数调用 </span></span><br><span class="line">    <span class="function">Person <span class="title">person1</span><span class="params">(<span class="string">&quot;老王&quot;</span>,<span class="number">170</span>,<span class="number">10000</span>)</span></span>;   <span class="comment">//结果：有参构造调用</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;person1.m_Name&lt;&lt;<span class="string">&quot;  身高：&quot;</span>&lt;&lt;person1.m_Tall&lt;&lt;<span class="string">&quot;  身家：&quot;</span> &lt;&lt;person1.m_Money&lt;&lt;endl; </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>按类型：分为普通构造函数和拷贝构造函数（复制构造函数)  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Person</span>(string name,<span class="keyword">int</span> tall,<span class="keyword">int</span> money)</span><br><span class="line">	&#123;</span><br><span class="line">		m_Name=name;</span><br><span class="line">		m_Tall=tall;</span><br><span class="line">		m_Money=money;</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot;有参构造函数调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">Person</span>(<span class="keyword">const</span> Person &amp;person)</span><br><span class="line">	&#123;</span><br><span class="line">		m_Name=person.m_Name;</span><br><span class="line">		m_Tall=person.m_Tall;</span><br><span class="line">		m_Money=person.m_Money;</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot;拷贝构造函数调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">	&#125; </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	string m_Name;</span><br><span class="line">	<span class="keyword">int</span> m_Tall;</span><br><span class="line">	<span class="keyword">int</span> m_Money;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Person <span class="title">person1</span><span class="params">(<span class="string">&quot;老王&quot;</span>,<span class="number">170</span>,<span class="number">10000</span>)</span></span>;   <span class="comment">//结果：有参构造函数调用</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;person1.m_Name&lt;&lt;<span class="string">&quot;  身高：&quot;</span>&lt;&lt;person1.m_Tall&lt;&lt;<span class="string">&quot;  身家：&quot;</span>&lt;&lt;person1.m_Money&lt;&lt;endl; </span><br><span class="line">    </span><br><span class="line">    <span class="function">Person <span class="title">person2</span><span class="params">(person1)</span></span>;         <span class="comment">//结果：拷贝构造函数调用</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;person2.m_Name&lt;&lt;<span class="string">&quot;  身高：&quot;</span>&lt;&lt;person2.m_Tall&lt;&lt;<span class="string">&quot;  身家：&quot;</span>&lt;&lt;person2.m_Money&lt;&lt;endl; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2、调用"><a href="#2、调用" class="headerlink" title="2、调用"></a>2、调用</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//无参构造</span></span><br><span class="line">    <span class="built_in">Person</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        m_Name=<span class="string">&quot;无参构造&quot;</span>;</span><br><span class="line">        m_Tall=<span class="number">120</span>;</span><br><span class="line">        m_Money=<span class="number">5000</span>; </span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;无参构造函数调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//有参构造</span></span><br><span class="line">    <span class="built_in">Person</span>(string name)</span><br><span class="line">    &#123;</span><br><span class="line">    	m_Name=name;</span><br><span class="line">    	m_Tall=<span class="number">0</span>;</span><br><span class="line">    	m_Money=<span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">Person</span>(<span class="keyword">int</span> tall)</span><br><span class="line">    &#123;</span><br><span class="line">    	m_Name=<span class="string">&quot; &quot;</span>;</span><br><span class="line">    	m_Tall=tall;</span><br><span class="line">    	m_Money=<span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">Person</span>(string name,<span class="keyword">int</span> tall,<span class="keyword">int</span> money)</span><br><span class="line">	&#123;</span><br><span class="line">		m_Name=name;</span><br><span class="line">		m_Tall=tall;</span><br><span class="line">		m_Money=money;</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot;有参构造函数调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">//拷贝构造</span></span><br><span class="line">	<span class="built_in">Person</span>(<span class="keyword">const</span> Person &amp;person)</span><br><span class="line">	&#123;</span><br><span class="line">		m_Name=person.m_Name;</span><br><span class="line">		m_Tall=person.m_Tall;</span><br><span class="line">		m_Money=person.m_Money;</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot;拷贝构造函数调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">	&#125; </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	string m_Name;</span><br><span class="line">	<span class="keyword">int</span> m_Tall;</span><br><span class="line">	<span class="keyword">int</span> m_Money;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>无参构造调用</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Person person;        <span class="comment">//结果：无参构造函数调用</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;person.m_Name&lt;&lt;<span class="string">&quot;  身高：&quot;</span>&lt;&lt;person.m_Tall&lt;&lt;<span class="string">&quot;  身家：&quot;</span>&lt;&lt;person.m_Money&lt;&lt;endl; </span><br><span class="line">                         <span class="comment">//姓名：无参构造  身高：120  身家：5000  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>有参构造调用</p>
<ul>
<li><p>括号法</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Person <span class="title">person1</span><span class="params">(<span class="string">&quot;老王&quot;</span>,<span class="number">170</span>,<span class="number">10000</span>)</span></span>;   <span class="comment">//结果：有参构造函数调用</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;person1.m_Name&lt;&lt;<span class="string">&quot;  身高：&quot;</span>&lt;&lt;person1.m_Tall&lt;&lt;<span class="string">&quot;  身家：&quot;</span>&lt;&lt;person1.m_Money&lt;&lt;endl; </span><br><span class="line">                                       <span class="comment">//结果：姓名：老王  身高：170  身家：10000 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>显示法</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Person person1=<span class="built_in">Person</span>(<span class="string">&quot;老李&quot;</span>,<span class="number">170</span>,<span class="number">10000</span>);   <span class="comment">//结果：有参构造调用</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;person1.m_Name&lt;&lt;<span class="string">&quot;  身高：&quot;</span>&lt;&lt;person1.m_Tall&lt;&lt;<span class="string">&quot;  身家：&quot;</span>&lt;&lt;person1.m_Money&lt;&lt;endl; </span><br><span class="line">                                               <span class="comment">//结果：姓名：老李  身高：170  身家：10000 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>隐式法</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Person person1=(<span class="number">160</span>,<span class="number">170</span>,<span class="number">175</span>);</span><br><span class="line">    <span class="comment">//等价于----Person person1=Person(175)</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;person1.m_Name&lt;&lt;<span class="string">&quot;  身高：&quot;</span>&lt;&lt;person1.m_Tall&lt;&lt;<span class="string">&quot;  身家：&quot;</span>&lt;&lt;person1.m_Money&lt;&lt;endl; </span><br><span class="line">                 <span class="comment">//结果：姓名：   身高：175  身家：0  </span></span><br><span class="line">    <span class="comment">//注意：这里去参数列表最后一个值然后匹配只有一个参数的构造函数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>拷贝构造调用</p>
<ul>
<li><p>括号法</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Person <span class="title">person1</span><span class="params">(<span class="string">&quot;老王&quot;</span>,<span class="number">170</span>,<span class="number">10000</span>)</span></span>;   <span class="comment">//结果：有参构造函数调用</span></span><br><span class="line">    <span class="function">Person <span class="title">person2</span><span class="params">(person1)</span></span>;            <span class="comment">//结果：拷贝构造函数调用</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;person2.m_Name&lt;&lt;<span class="string">&quot;  身高：&quot;</span>&lt;&lt;person2.m_Tall&lt;&lt;<span class="string">&quot;  身家：&quot;</span>&lt;&lt;person2.m_Money&lt;&lt;endl;</span><br><span class="line">                                        <span class="comment">//结果：姓名：老王  身高：170  身家：10000  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>隐式法</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Person <span class="title">person1</span><span class="params">(<span class="string">&quot;老王&quot;</span>,<span class="number">170</span>,<span class="number">10000</span>)</span></span>;   <span class="comment">//结果：有参构造函数调用</span></span><br><span class="line">    Person person2=person1;            <span class="comment">//结果：拷贝构造函数调用</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;person2.m_Name&lt;&lt;<span class="string">&quot;  身高：&quot;</span>&lt;&lt;person2.m_Tall&lt;&lt;<span class="string">&quot;  身家：&quot;</span>&lt;&lt;person2.m_Money&lt;&lt;endl;</span><br><span class="line">                                        <span class="comment">//结果：姓名：老王  身高：170  身家：10000  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>匿名对象</p>
<p>匿名对象，没有名字的对象–特点：当前行执行完后 立即释放</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">Person</span>(<span class="string">&quot;老王&quot;</span>,<span class="number">165</span>,<span class="number">5000</span>);   <span class="comment">//立即释放，无法访问对象的成员</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>匿名对象用来初始化一个对象</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Person <span class="title">person</span><span class="params">(Person(<span class="number">150</span>))</span></span>;</span><br><span class="line">    <span class="comment">//等价于----Person person=Person(150)</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;person.m_Name&lt;&lt;<span class="string">&quot;  身高：&quot;</span>&lt;&lt;person.m_Tall&lt;&lt;<span class="string">&quot;  身家：&quot;</span>&lt;&lt;person.m_Money&lt;&lt;endl; </span><br><span class="line">                                    <span class="comment">//结果：姓名：   身高：150  身家：0 </span></span><br><span class="line">    </span><br><span class="line">    <span class="function">Person <span class="title">person1</span><span class="params">(Person(<span class="string">&quot;朱老师&quot;</span>,<span class="number">175</span>,<span class="number">8000</span>))</span></span>;</span><br><span class="line">    <span class="comment">//等价于-----Person person=Person(&quot;朱老师&quot;,175,8000)</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;person1.m_Name&lt;&lt;<span class="string">&quot;  身高：&quot;</span>&lt;&lt;person1.m_Tall&lt;&lt;<span class="string">&quot;  身家：&quot;</span>&lt;&lt;person1.m_Money&lt;&lt;endl;</span><br><span class="line">                                    <span class="comment">//结果：姓名：朱老师  身高：175  身家：8000 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意: 使用匿名对象初始化判断调用哪一个构造函数，要看匿名对象的参数类型</p>
</li>
</ol>
<h3 id="3、注意事项"><a href="#3、注意事项" class="headerlink" title="3、注意事项"></a>3、注意事项</h3><ol>
<li><p>不要用括号法调用无参构造函数——编译器会认为代码是函数的声明—Person();</p>
</li>
<li><p>不要用拷贝构造函数 初始化 匿名对象 <code>Person(p3); </code>编译器认为 <code>Person p3</code>对象实例化  如果已经有<code>p3 </code> <code>p3</code>就重定义</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Teacher</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Teacher</span>()</span><br><span class="line">    &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;默认构造函数!&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">Teacher</span>(<span class="keyword">const</span> Teacher&amp; teacher)</span><br><span class="line">    &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;拷贝构造函数!&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">int</span> mAge;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Teacher t1;</span><br><span class="line">	<span class="comment">//error C2086:“Teacher t1”: 重定义</span></span><br><span class="line">	<span class="built_in">Teacher</span>(t1);  <span class="comment">//此时等价于 Teacher t1;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>匿名对象  特点： 当前行执行完后 立即释放</p>
</li>
</ol>
<h2 id="3、拷贝构造函数的调用时机"><a href="#3、拷贝构造函数的调用时机" class="headerlink" title="3、拷贝构造函数的调用时机"></a>3、拷贝构造函数的调用时机</h2><h3 id="1、用已经创建好的对象来初始化新的对象"><a href="#1、用已经创建好的对象来初始化新的对象" class="headerlink" title="1、用已经创建好的对象来初始化新的对象"></a>1、用已经创建好的对象来初始化新的对象</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Person <span class="title">person</span><span class="params">(<span class="string">&quot;仓井老师&quot;</span>,<span class="number">160</span>,<span class="number">1000000</span>)</span></span>;   <span class="comment">//结果：有参构造函数调用</span></span><br><span class="line">    Person person1=person;                  <span class="comment">//结果：拷贝构造函数调用</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;person1.m_Name&lt;&lt;<span class="string">&quot;  身高：&quot;</span>&lt;&lt;person1.m_Tall&lt;&lt;<span class="string">&quot;  身家：&quot;</span>&lt;&lt;person1.m_Money&lt;&lt;endl;</span><br><span class="line">                                            <span class="comment">//结果：姓名：仓井老师  身高：160  身家：1000000 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2、值传递的方式-给函数参数传值"><a href="#2、值传递的方式-给函数参数传值" class="headerlink" title="2、值传递的方式 给函数参数传值"></a>2、值传递的方式 给函数参数传值</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(Person person)</span>      <span class="comment">//等价于----Person person=person1</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;person.m_Name&lt;&lt;<span class="string">&quot;  身高：&quot;</span>&lt;&lt;person.m_Tall&lt;&lt;<span class="string">&quot;  身家：&quot;</span>&lt;&lt;person.m_Money&lt;&lt;endl;</span><br><span class="line">                             <span class="comment">//结果：姓名：朱辅导  身高：175  身家：10000 </span></span><br><span class="line">&#125;  </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Person <span class="title">person1</span><span class="params">(<span class="string">&quot;朱辅导&quot;</span>,<span class="number">175</span>,<span class="number">10000</span>)</span></span>;    <span class="comment">//结果：有参构造函数调用</span></span><br><span class="line">    <span class="built_in">func</span>(person1);                        <span class="comment">//结果：拷贝构造函数调用  --函数结束会调用析构函数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3、以值返回方式-返回局部对象"><a href="#3、以值返回方式-返回局部对象" class="headerlink" title="3、以值返回方式 返回局部对象"></a>3、以值返回方式 返回局部对象</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Person <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Person <span class="title">person</span><span class="params">(<span class="string">&quot;鹅厂大佬&quot;</span>,<span class="number">178</span>,<span class="number">5000000</span>)</span></span>;    <span class="comment">// person是局部变量，在函数执行完将会进行析构</span></span><br><span class="line">    <span class="keyword">return</span> person;      <span class="comment">//会存在Person tmp=person    在主调函数中如果有变量接受  tmp的话就不会立刻释放</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Person person1=<span class="built_in">func</span>();   <span class="comment">//这一过程没有调用拷贝构造函数，而是直接将tmp转正为person1</span></span><br><span class="line">    <span class="comment">//cout&lt;&lt;&quot;姓名：&quot;&lt;&lt;person1.m_Name&lt;&lt;&quot;  身高：&quot;&lt;&lt;person1.m_Tall&lt;&lt;&quot;  身家：&quot;&lt;&lt;person1.m_Money&lt;&lt;endl;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">func</span>();   <span class="comment">//函数结束后调用析构函数立即释放tmp对象  </span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;func执行完了&quot;</span> &lt;&lt; endl; <span class="comment">//tmp在此之前被析构，相当于匿名对象，使用完就会被析构</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4、构造函数的调用规则"><a href="#4、构造函数的调用规则" class="headerlink" title="4、构造函数的调用规则"></a>4、构造函数的调用规则</h2><ol>
<li><p>编译器会给一个类 至少添加3个函数   </p>
<pre><code>* 默认构造函数(无参，函数体为空)
* 默认析构函数(无参，函数体为空)
* 默认拷贝构造函数，对类中非静态成员属性简单值拷贝
</code></pre>
</li>
<li><p>如果我们自己提供了 有参构造函数，编译器就不会提供默认构造函数，但是依然会提供拷贝构造函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//有参构造</span></span><br><span class="line">    <span class="built_in">Student</span>(string name,<span class="keyword">int</span> age)</span><br><span class="line">    &#123;</span><br><span class="line">        m_Name=name;</span><br><span class="line">        m_Age=age;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    string m_Name;</span><br><span class="line">    <span class="keyword">int</span> m_Age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//Student stu;      //报错---没有可调用的无参构造函数</span></span><br><span class="line">    <span class="function">Student <span class="title">stu1</span><span class="params">(<span class="string">&quot;张总&quot;</span>,<span class="number">22</span>)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>如果我们自己提供了 拷贝构造函数，编译器就不会提供其他构造函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//无参构造</span></span><br><span class="line">    <span class="built_in">Student</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        m_Name=<span class="string">&quot;抖音衣哥&quot;</span>;</span><br><span class="line">        m_Age=<span class="number">20</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//拷贝构造</span></span><br><span class="line">    <span class="built_in">Student</span>(<span class="keyword">const</span> Student &amp;stu)</span><br><span class="line">    &#123;</span><br><span class="line">        m_Name=stu.m_Name;</span><br><span class="line">        m_Age=stu.m_Age;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;调用拷贝构造函数&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    string m_Name;</span><br><span class="line">    <span class="keyword">int</span> m_Age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Student stu;      </span><br><span class="line">    <span class="comment">//Student stu1(&quot;张总&quot;,22);   //报错---没有可调用的有参构造函数</span></span><br><span class="line">    Student stu1=<span class="built_in">Student</span>(stu);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="5、深拷贝与浅拷贝的问题以及解决"><a href="#5、深拷贝与浅拷贝的问题以及解决" class="headerlink" title="5、深拷贝与浅拷贝的问题以及解决"></a>5、深拷贝与浅拷贝的问题以及解决</h2><h3 id="1、浅拷贝"><a href="#1、浅拷贝" class="headerlink" title="1、浅拷贝"></a>1、浅拷贝</h3><p>同一类型的对象之间可以赋值，使得两个对象的成员变量的值相同，两个对象仍然是独立的两个对象，这种情况被称为<strong>浅拷贝</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">String</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//有参构造函数</span></span><br><span class="line">    <span class="built_in">String</span>(<span class="keyword">int</span> age)</span><br><span class="line">    &#123;</span><br><span class="line">        m_Age=age;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;有参构造调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//拷贝构造函数（浅拷贝）--编译器提供可省略</span></span><br><span class="line">    <span class="built_in">String</span>(<span class="keyword">const</span> String &amp;str)</span><br><span class="line">    &#123;</span><br><span class="line">        m_Age=str.m_Age;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;拷贝构造调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//析构函数（无动态内存分配采样编译器自动添加的无需重写--省略）</span></span><br><span class="line">    ~<span class="built_in">String</span>()&#123;cout&lt;&lt;<span class="string">&quot;析构调用&quot;</span>&lt;&lt;endl;&#125;</span><br><span class="line">    <span class="keyword">int</span> m_Age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">String <span class="title">str</span><span class="params">(<span class="number">15</span>)</span></span>;   <span class="comment">//有参调用</span></span><br><span class="line">    <span class="function">String <span class="title">str1</span><span class="params">(str)</span></span>;  <span class="comment">//拷贝构造调用</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//两次析构调用</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>一般情况下，浅拷贝没有任何副作用，但是当类中有指针，并且指针指向动态分配的内存空间，析构函数做了动态内存释放的处理，会导致内存问题。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myString</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//有参构造</span></span><br><span class="line">    <span class="built_in">myString</span>(<span class="keyword">char</span> *name)</span><br><span class="line">    &#123;</span><br><span class="line">        m_Name=(<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="built_in">strlen</span>(name)+<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">strcpy</span>(m_Name,name);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;有参构造调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//不重写拷贝构造函数</span></span><br><span class="line">    <span class="comment">//析构函数</span></span><br><span class="line">    ~<span class="built_in">myString</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(m_Name)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">free</span>(m_Name);</span><br><span class="line">            m_Name=<span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;析构调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">char</span> *m_Name;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">myString <span class="title">str</span><span class="params">(<span class="string">&quot;小野马&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">myString <span class="title">str1</span><span class="params">(str)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//代码会编译过，但在运行过程中会报错，</span></span><br><span class="line"><span class="comment">//问题所在：(1)两个（或两个以上）指针指向同一块空间，这个内存就会被释放多次；</span></span><br><span class="line"><span class="comment">//(2)两个指针指向同一块空间时，一旦一个指针修改了这块空间的值，另一个指针指向的空间的值也会被修改。</span></span><br></pre></td></tr></table></figure>

<h3 id="2、深拷贝"><a href="#2、深拷贝" class="headerlink" title="2、深拷贝"></a>2、深拷贝</h3><p>重写拷贝构造函数，在函数内部给新对象的指针分配内存</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">myString</span>(<span class="keyword">const</span> myString &amp;str)</span><br><span class="line">&#123;</span><br><span class="line">    m_Name=(<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="built_in">strlen</span>(str.m_Name)+<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(m_Name,str.m_Name);</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;深拷贝构造调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="析构函数"><a href="#析构函数" class="headerlink" title="析构函数"></a>析构函数</h1><p>析构函数主要用于对象<strong>销毁前</strong>系统自动调用，执行一些清理工作。</p>
<h2 id="1、析构函数语法"><a href="#1、析构函数语法" class="headerlink" title="1、析构函数语法"></a>1、析构函数语法</h2><ul>
<li>析构函数没有返回值，不能用void</li>
<li>析构函数名是在类名前加 ~ </li>
<li>析构函数不能有参数</li>
<li>析构函数不能重载</li>
<li><code>~classname()&#123; &#125;</code></li>
</ul>
<h1 id="explicit关键字"><a href="#explicit关键字" class="headerlink" title="explicit关键字"></a>explicit关键字</h1><p>c++提供了关键字explicit，禁止通过构造函数进行的隐式转换。声明为explicit的构造函数不能在隐式转换中使用。</p>
<p>explicit注意：</p>
<ul>
<li>explicit用于修饰构造函数,防止隐式转化。</li>
<li>是针对单参数的构造函数(或者除了第一个参数外其余参数都有默认值的多参构造)而言。</li>
<li>作用是表明该构造函数是显示的, 而非隐式的, 跟它相对应的另一个关键字是implicit, 意思是隐藏的,类构造函数默认情况下即声明为implicit(隐式).</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CxString</span>  </span></span><br><span class="line"><span class="class">&#123;</span>  </span><br><span class="line"><span class="keyword">public</span>:  </span><br><span class="line">    <span class="keyword">char</span> *_pstr;  </span><br><span class="line">    <span class="keyword">int</span> _size;  </span><br><span class="line">    <span class="built_in">CxString</span>(<span class="keyword">int</span> size)         <span class="comment">// 没有使用explicit关键字的类声明, 即默认为隐式</span></span><br><span class="line">    &#123;  </span><br><span class="line">        _size = size;                <span class="comment">// string的预设大小  </span></span><br><span class="line">        _pstr = <span class="built_in">malloc</span>(size + <span class="number">1</span>);    <span class="comment">// 分配string的内存  </span></span><br><span class="line">        <span class="built_in">memset</span>(_pstr, <span class="number">0</span>, size + <span class="number">1</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="built_in">CxString</span>(<span class="keyword">const</span> <span class="keyword">char</span> *p)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">int</span> size = <span class="built_in">strlen</span>(p);  </span><br><span class="line">        _pstr = <span class="built_in">malloc</span>(size + <span class="number">1</span>);    <span class="comment">// 分配string的内存  </span></span><br><span class="line">        <span class="built_in">strcpy</span>(_pstr, p);            <span class="comment">// 复制字符串  </span></span><br><span class="line">        _size = <span class="built_in">strlen</span>(_pstr);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 下面是调用:  </span></span><br><span class="line">    <span class="function">CxString <span class="title">string1</span><span class="params">(<span class="number">24</span>)</span></span>;     <span class="comment">// 这样是OK的, 为CxString预分配24字节的大小的内存  </span></span><br><span class="line">    CxString string2 = <span class="number">10</span>;    <span class="comment">// 这样是OK的, 为CxString预分配10字节的大小的内存  </span></span><br><span class="line">    CxString string3;         <span class="comment">// 这样是不行的, 因为没有默认构造函数, 错误为: “CxString”: 没有合适的默认构造函数可用  </span></span><br><span class="line">    <span class="function">CxString <span class="title">string4</span><span class="params">(<span class="string">&quot;aaaa&quot;</span>)</span></span>; <span class="comment">// 这样是OK的  </span></span><br><span class="line">    CxString string5 = <span class="string">&quot;bbb&quot;</span>; <span class="comment">// 这样也是OK的, 调用的是CxString(const char *p)  </span></span><br><span class="line">    CxString string6 = <span class="string">&#x27;c&#x27;</span>;   <span class="comment">// 这样也是OK的, 其实调用的是CxString(int size), 且size等于&#x27;c&#x27;的ascii码  </span></span><br><span class="line">    string1 = <span class="number">2</span>;              <span class="comment">// 这样也是OK的, 为CxString预分配2字节的大小的内存  </span></span><br><span class="line">    string2 = <span class="number">3</span>;              <span class="comment">// 这样也是OK的, 为CxString预分配3字节的大小的内存  </span></span><br><span class="line">    string3 = string1;        <span class="comment">// 这样也是OK的, 至少编译是没问题的, 但是如果析构函数里用free释放_pstr内存指针的时候可能会报错, 完整的代码必须重载运算符&quot;=&quot;, 并在其中处理内存释放  </span></span><br></pre></td></tr></table></figure>

<p> 上面的代码中, <code>CxString string2 = 10;</code> 这句为什么是可以的呢? 在C++中, 如果的构造函数只有一个参数时, 那么在编译的时候就会有一个缺省的转换操作:将该构造函数对应数据类型的数据转换为该类对象. 也就是说<code>CxString string2 = 10; </code>这段代码, 编译器自动将整型转换为<code>CxString</code>类对象, 实际上等同于下面的操作:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">CxString <span class="title">string2</span><span class="params">(<span class="number">10</span>)</span></span>;  </span><br><span class="line">或  </span><br><span class="line"><span class="function">CxString <span class="title">temp</span><span class="params">(<span class="number">10</span>)</span></span>;  </span><br><span class="line">CxString string2 = temp; </span><br></pre></td></tr></table></figure>

<p>但是, 上面的代码中的_size代表的是字符串内存分配的大小, 那么调用的第二句 <code>CxString string2 = 10;</code> 和第六句 <code>CxString string6 = &#39;c&#39;;&quot;</code>就显得不伦不类, 而且容易让人疑惑</p>
<p>解决办法：使用explicit关键字 修饰构造函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CxString</span>  </span></span><br><span class="line"><span class="class">&#123;</span>  </span><br><span class="line"><span class="keyword">public</span>:  </span><br><span class="line">    <span class="keyword">char</span> *_pstr;  </span><br><span class="line">    <span class="keyword">int</span> _size;  </span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">CxString</span><span class="params">(<span class="keyword">int</span> size)</span>     <span class="comment">// 使用关键字explicit的类声明, 显示转换  </span></span></span><br><span class="line"><span class="function">    </span>&#123;  </span><br><span class="line">        _size = size;                <span class="comment">// string的预设大小  </span></span><br><span class="line">        _pstr = <span class="built_in">malloc</span>(size + <span class="number">1</span>);    <span class="comment">// 分配string的内存  </span></span><br><span class="line">        <span class="built_in">memset</span>(_pstr, <span class="number">0</span>, size + <span class="number">1</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="built_in">CxString</span>(<span class="keyword">const</span> <span class="keyword">char</span> *p)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">int</span> size = <span class="built_in">strlen</span>(p);  </span><br><span class="line">        _pstr = <span class="built_in">malloc</span>(size + <span class="number">1</span>);    <span class="comment">// 分配string的内存  </span></span><br><span class="line">        <span class="built_in">strcpy</span>(_pstr, p);            <span class="comment">// 复制字符串  </span></span><br><span class="line">        _size = <span class="built_in">strlen</span>(_pstr);  </span><br><span class="line">    &#125; </span><br><span class="line">&#125;;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 下面是调用:  </span></span><br><span class="line">    <span class="function">CxString <span class="title">string1</span><span class="params">(<span class="number">24</span>)</span></span>;     <span class="comment">// 这样是OK的  </span></span><br><span class="line">    CxString string2 = <span class="number">10</span>;    <span class="comment">// 这样是不行的, 因为explicit关键字取消了隐式转换  </span></span><br><span class="line">    CxString string3;         <span class="comment">// 这样是不行的, 因为没有默认构造函数  </span></span><br><span class="line">    <span class="function">CxString <span class="title">string4</span><span class="params">(<span class="string">&quot;aaaa&quot;</span>)</span></span>; <span class="comment">// 这样是OK的  </span></span><br><span class="line">    CxString string5 = <span class="string">&quot;bbb&quot;</span>; <span class="comment">// 这样也是OK的, 调用的是CxString(const char *p)  </span></span><br><span class="line">    CxString string6 = <span class="string">&#x27;c&#x27;</span>;   <span class="comment">// 这样是不行的, 其实调用的是CxString(int size), 且size等于&#x27;c&#x27;的ascii码, 但explicit关键字取消了隐式转换  </span></span><br><span class="line">    string1 = <span class="number">2</span>;              <span class="comment">// 这样也是不行的, 因为取消了隐式转换  </span></span><br><span class="line">    string2 = <span class="number">3</span>;              <span class="comment">// 这样也是不行的, 因为取消了隐式转换  </span></span><br><span class="line">    string3 = string1;        <span class="comment">// 这样也是不行的, 因为取消了隐式转换, 除非类实现操作符&quot;=&quot;的重载  </span></span><br></pre></td></tr></table></figure>

<p>explicit关键字只对有一个参数的类构造函数有效, 如果类构造函数参数大于或等于两个时, 是不会产生隐式转换的, 所以explicit关键字也就无效了. 例如: </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CxString</span> </span></span><br><span class="line"><span class="class">&#123;</span>  </span><br><span class="line"><span class="keyword">public</span>:  </span><br><span class="line">    <span class="keyword">char</span> *_pstr;  </span><br><span class="line">    <span class="keyword">int</span> _age;  </span><br><span class="line">    <span class="keyword">int</span> _size;  </span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">CxString</span><span class="params">(<span class="keyword">int</span> age, <span class="keyword">int</span> size)</span>      <span class="comment">// explicit关键字在类构造函数参数大于或等于两个时无效  </span></span></span><br><span class="line"><span class="function">    </span>&#123;  </span><br><span class="line">        _age = age;  </span><br><span class="line">        _size = size;                 <span class="comment">// string的预设大小 </span></span><br><span class="line">        _pstr = <span class="built_in">malloc</span>(size + <span class="number">1</span>);     <span class="comment">// 分配string的内存  </span></span><br><span class="line">        <span class="built_in">memset</span>(_pstr, <span class="number">0</span>, size + <span class="number">1</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="built_in">CxString</span>(<span class="keyword">const</span> <span class="keyword">char</span> *p)  </span><br><span class="line">     &#123;  </span><br><span class="line">        <span class="keyword">int</span> size = <span class="built_in">strlen</span>(p);  </span><br><span class="line">        _pstr = <span class="built_in">malloc</span>(size + <span class="number">1</span>);    <span class="comment">// 分配string的内存  </span></span><br><span class="line">        <span class="built_in">strcpy</span>(_pstr, p);            <span class="comment">// 复制字符串  </span></span><br><span class="line">        _size = <span class="built_in">strlen</span>(_pstr);  </span><br><span class="line">    &#125; </span><br><span class="line">&#125;;  </span><br><span class="line">    <span class="comment">// 这个时候有没有explicit关键字都是一样的  </span></span><br></pre></td></tr></table></figure>

<p>但是, 也有一个例外, 就是当除了第一个参数以外的其他参数都有默认值的时候, explicit关键字依然有效, 此时, 当调用构造函数时只传入一个参数, 等效于只有一个参数的类构造函数, 例子如下:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CxString</span>  // 使用关键字<span class="title">explicit</span>声明  </span></span><br><span class="line"><span class="class">&#123;</span>  </span><br><span class="line"><span class="keyword">public</span>:  </span><br><span class="line">    <span class="keyword">int</span> _age;  </span><br><span class="line">    <span class="keyword">int</span> _size;  </span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">CxString</span><span class="params">(<span class="keyword">int</span> age, <span class="keyword">int</span> size = <span class="number">0</span>)</span>  </span></span><br><span class="line"><span class="function">    </span>&#123;  </span><br><span class="line">        _age = age;  </span><br><span class="line">        _size = size;  </span><br><span class="line">        _pstr = <span class="built_in">malloc</span>(size + <span class="number">1</span>);     <span class="comment">// 分配string的内存  </span></span><br><span class="line">        <span class="built_in">memset</span>(_pstr, <span class="number">0</span>, size + <span class="number">1</span>); </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="built_in">CxString</span>(<span class="keyword">const</span> <span class="keyword">char</span> *p)  </span><br><span class="line">     &#123;  </span><br><span class="line">        <span class="keyword">int</span> size = <span class="built_in">strlen</span>(p);  </span><br><span class="line">        _pstr = <span class="built_in">malloc</span>(size + <span class="number">1</span>);    <span class="comment">// 分配string的内存  </span></span><br><span class="line">        <span class="built_in">strcpy</span>(_pstr, p);            <span class="comment">// 复制字符串  </span></span><br><span class="line">        _size = <span class="built_in">strlen</span>(_pstr);  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 下面是调用:  </span></span><br><span class="line">    <span class="function">CxString <span class="title">string1</span><span class="params">(<span class="number">24</span>)</span></span>;     <span class="comment">// 这样是OK的  </span></span><br><span class="line">    CxString string2 = <span class="number">10</span>;    <span class="comment">// 这样是不行的, 因为explicit关键字取消了隐式转换  </span></span><br><span class="line">    CxString string3;         <span class="comment">// 这样是不行的, 因为没有默认构造函数  </span></span><br><span class="line">    string1 = <span class="number">2</span>;              <span class="comment">// 这样也是不行的, 因为取消了隐式转换  </span></span><br><span class="line">    string2 = <span class="number">3</span>;              <span class="comment">// 这样也是不行的, 因为取消了隐式转换  </span></span><br><span class="line">    string3 = string1;        <span class="comment">// 这样也是不行的, 因为取消了隐式转换, 除非类实现操作符&quot;=&quot;的重载  </span></span><br></pre></td></tr></table></figure>




      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smilesrx.github.io/2021/04/21/C++/C++%E5%B0%81%E8%A3%85/C++%E5%B0%81%E8%A3%85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CandyKing">
      <meta itemprop="description" content="虾米">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆玺之路">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/21/C++/C++%E5%B0%81%E8%A3%85/C++%E5%B0%81%E8%A3%85/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-21 20:23:45" itemprop="dateCreated datePublished" datetime="2021-04-21T20:23:45+08:00">2021-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-11 17:28:44" itemprop="dateModified" datetime="2020-10-11T17:28:44+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="类的封装"><a href="#类的封装" class="headerlink" title="类的封装"></a>类的封装</h1><p>如何用程序语言来表示现实事物？现实世界的事物所具有的共性就是每个事物都具有自身的属性，一些自身具有的行为，所以如果我们能把事物的属性和行为表示出来，那么就可以抽象出来这个事物。</p>
<h2 id="1、C语言封装的缺陷"><a href="#1、C语言封装的缺陷" class="headerlink" title="1、C语言封装的缺陷"></a>1、C语言封装的缺陷</h2><p>将属性和行为分离（类型检测不强）</p>
<p>经典例子：人吃狗粮</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//人类--结构体</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">//人的属性</span></span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">60</span>];   <span class="comment">//姓名</span></span><br><span class="line">    <span class="keyword">int</span> age;         <span class="comment">//年龄</span></span><br><span class="line">&#125;Person;</span><br><span class="line"><span class="comment">//人类--行为</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Person_Eat</span><span class="params">(Person *person)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d的%s在吃人饭\n&quot;</span>,person-&gt;age,person-&gt;name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//狗类--结构体</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Dog</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">60</span>];   <span class="comment">//姓名</span></span><br><span class="line">    <span class="keyword">int</span> age;         <span class="comment">//年龄</span></span><br><span class="line">&#125;Dog;</span><br><span class="line"><span class="comment">//狗类--行为</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Dog_Eat</span><span class="params">(Dog *dog)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d的%s在吃狗粮\n&quot;</span>,dog-&gt;age,dog-&gt;name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Person person;</span><br><span class="line">    <span class="built_in">strcpy</span>(person.name,<span class="string">&quot;老王&quot;</span>);</span><br><span class="line">    person.age=<span class="number">18</span>;</span><br><span class="line">    </span><br><span class="line">    Dog dog;</span><br><span class="line">    <span class="built_in">strcpy</span>(dog.name,<span class="string">&quot;旺财&quot;</span>);</span><br><span class="line">    dog.age=<span class="number">5</span>;</span><br><span class="line">    </span><br><span class="line">    Person_Eat(&amp;dog);  <span class="comment">//结果：5岁的旺财在吃人饭</span></span><br><span class="line">    Dog_Eat(&amp;person);  <span class="comment">//结果：18岁的老王在吃狗粮</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>封装特性包含两个方面，一个是属性和变量合成一个整体，一个是给属性和函数增加访问权限。</p>
<h2 id="2、C-封装"><a href="#2、C-封装" class="headerlink" title="2、C++封装"></a>2、C++封装</h2><ol>
<li><p>封装</p>
<ul>
<li><p>把属性（变量）和行为（函数）合成一个整体，封装在一个类中</p>
</li>
<li><p>对变量和函数进行访问权限控制</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//人类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//属性</span></span><br><span class="line">    string m_Name;</span><br><span class="line">    <span class="keyword">int</span> m_Age;</span><br><span class="line">    <span class="comment">//行为</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Person_Eat</span><span class="params">(Person *person)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout&lt;&lt;person-&gt;m_Age&lt;&lt;<span class="string">&quot;岁的&quot;</span>&lt;&lt;person-&gt;m_Name&lt;&lt;<span class="string">&quot;在吃人饭&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//狗类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//属性</span></span><br><span class="line">    string m_Name;</span><br><span class="line">    <span class="keyword">int</span> m_Age;</span><br><span class="line">    <span class="comment">//行为</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Dog_Eat</span><span class="params">(Dog *dog)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout&lt;&lt;dog-&gt;m_Age&lt;&lt;<span class="string">&quot;岁的&quot;</span>&lt;&lt;dog-&gt;m_Name&lt;&lt;<span class="string">&quot;在吃狗粮&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Person person;</span><br><span class="line">    person.m_Name=<span class="string">&quot;老王&quot;</span>;</span><br><span class="line">    person.m_Age=<span class="number">20</span>;</span><br><span class="line">    person.<span class="built_in">Person_Eat</span>(&amp;person);</span><br><span class="line">    </span><br><span class="line">    Dog dog;</span><br><span class="line">    dog.m_Age=<span class="number">8</span>;</span><br><span class="line">    dog.m_Name=<span class="string">&quot;旺财&quot;</span>; </span><br><span class="line">	dog.<span class="built_in">Dog_Eat</span>(&amp;dog); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>访问权限</p>
<ul>
<li><p>在类的内部(作用域范围内)，没有访问权限之分，所有成员可以相互访问</p>
</li>
<li><p>在类的外部(作用域范围外)，访问权限才有意义：public，private，protected</p>
</li>
<li><p>在类的外部，只有public修饰的成员才能被访问，在没有涉及继承与派生时，private和protected是同等级的，外部不允许访问</p>
<table>
<thead>
<tr>
<th align="center">访问属性</th>
<th align="center">属性</th>
<th align="center">对象内部</th>
<th align="center">对象外部</th>
</tr>
</thead>
<tbody><tr>
<td align="center">public</td>
<td align="center">共有</td>
<td align="center">可访问</td>
<td align="center">可访问</td>
</tr>
<tr>
<td align="center">protected</td>
<td align="center">保护</td>
<td align="center">可访问</td>
<td align="center">不可访问</td>
</tr>
<tr>
<td align="center">private</td>
<td align="center">私有</td>
<td align="center">可访问</td>
<td align="center">不可访问</td>
</tr>
</tbody></table>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>&#123;</span></span><br><span class="line"><span class="comment">//人具有的行为(函数)</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Dese</span><span class="params">()</span></span>&#123; cout &lt;&lt; <span class="string">&quot;我有钱，年轻，个子又高，就爱嘚瑟!&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line"><span class="comment">//人的属性(变量)</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">int</span> m_Tall; <span class="comment">//多高，可以让外人知道</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="keyword">int</span> m_Money; <span class="comment">// 有多少钱,只能儿子孙子知道</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> m_Age; <span class="comment">//年龄，不想让外人知道</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Person person;</span><br><span class="line">    person.<span class="built_in">Dese</span>();    <span class="comment">//可访问</span></span><br><span class="line">    person.m_Tall;    <span class="comment">//可访问</span></span><br><span class="line">    <span class="comment">//person.m_money;   //不可访问</span></span><br><span class="line">    <span class="comment">//person.m_Age;     //不可访问</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3、struct-和class的区别"><a href="#3、struct-和class的区别" class="headerlink" title="3、struct 和class的区别"></a>3、struct 和class的区别</h2><p>class默认访问权限为private,struct默认访问权限为public。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> m_A;   <span class="comment">//默认private权限</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">B</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> m_B;   <span class="comment">//默认public权限</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    A a;</span><br><span class="line">    a.m_A=<span class="number">10</span>;   <span class="comment">//不可访问</span></span><br><span class="line">    </span><br><span class="line">    B b;</span><br><span class="line">    b.m_B=<span class="number">20</span>;   <span class="comment">//可访问</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h1 id="将成员变量设置为私有属性–提高安全性"><a href="#将成员变量设置为私有属性–提高安全性" class="headerlink" title="将成员变量设置为私有属性–提高安全性"></a>将成员变量设置为私有属性–提高安全性</h1><h2 id="1、可赋予客户端访问数据的一致性。"><a href="#1、可赋予客户端访问数据的一致性。" class="headerlink" title="1、可赋予客户端访问数据的一致性。"></a>1、可赋予客户端访问数据的一致性。</h2><p>如果成员变量不是public，客户端唯一能够访问对象的方法就是通过成员函数。如果类中所有public权限的成员都是函数，客户在访问类成员时只会默认访问函数，不需要考虑访问的成员需不需要添加(),这就省下了许多搔首弄耳的时间。</p>
<h2 id="2、自己可以控制读写权限"><a href="#2、自己可以控制读写权限" class="headerlink" title="2、自己可以控制读写权限"></a>2、自己可以控制读写权限</h2><p>使用成员函数可使得我们对变量的控制处理更加精细。如果我们让所有的成员变量为public，每个人都可以读写它。如果我们设置为private，我们可以实现“不准访问”、“只读访问”、“读写访问”，甚至你可以写出“只写访问”。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AccessLevels</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">//对只读属性进行只读访问</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getReadOnly</span><span class="params">()</span></span>&#123; <span class="keyword">return</span> readOnly; &#125;</span><br><span class="line">	<span class="comment">//对读写属性进行读写访问</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">setReadWrite</span><span class="params">(<span class="keyword">int</span> val)</span></span>&#123; readWrite = val; &#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getReadWrite</span><span class="params">()</span></span>&#123; <span class="keyword">return</span> readWrite; &#125;</span><br><span class="line">	<span class="comment">//对只写属性进行只写访问</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">setWriteOnly</span><span class="params">(<span class="keyword">int</span> val)</span></span>&#123; writeOnly = val; &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> readOnly; <span class="comment">//对外只读访问</span></span><br><span class="line">	<span class="keyword">int</span> noAccess; <span class="comment">//外部不可访问</span></span><br><span class="line">	<span class="keyword">int</span> readWrite; <span class="comment">//读写访问</span></span><br><span class="line">	<span class="keyword">int</span> writeOnly; <span class="comment">//只写访问</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>示例：老王自己知道自己的情人是李婶，别人不知道</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//设置姓名</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Set_Name</span><span class="params">(string name)</span></span>&#123;m_Name=name;&#125; </span><br><span class="line">	<span class="comment">//获取姓名</span></span><br><span class="line">	<span class="function">string <span class="title">Get_Name</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> m_Name;&#125; </span><br><span class="line">	</span><br><span class="line">	<span class="comment">//设置年龄</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Set_Age</span><span class="params">(<span class="keyword">int</span> age)</span></span>&#123;m_Age=age;&#125;</span><br><span class="line">	<span class="comment">//获取年龄</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">Get_Age</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> m_Age;&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//设置情人 </span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Set_Lover</span><span class="params">(string lover)</span></span>&#123;m_Lover=lover;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	string m_Name;      <span class="comment">//姓名 </span></span><br><span class="line">	<span class="keyword">int</span> m_Age;         <span class="comment">//年龄 </span></span><br><span class="line">	string m_Lover;    <span class="comment">//情人 </span></span><br><span class="line">&#125;; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Person person;</span><br><span class="line">	<span class="comment">//设置姓名</span></span><br><span class="line">	person.<span class="built_in">Set_Name</span>(<span class="string">&quot;老王&quot;</span>); </span><br><span class="line">	<span class="comment">//获取姓名</span></span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;person.<span class="built_in">Get_Name</span>();</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//设置年龄</span></span><br><span class="line">	person.<span class="built_in">Set_Age</span>(<span class="number">50</span>);</span><br><span class="line">	<span class="comment">//获取年龄</span></span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;  年龄：&quot;</span>&lt;&lt;person.<span class="built_in">Get_Age</span>()&lt;&lt;endl;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//设置情人 </span></span><br><span class="line">	person.<span class="built_in">Set_Lover</span>(<span class="string">&quot;李婶&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="面向对象设计案例"><a href="#面向对象设计案例" class="headerlink" title="面向对象设计案例"></a>面向对象设计案例</h1><h2 id="1、立方体"><a href="#1、立方体" class="headerlink" title="1、立方体"></a>1、立方体</h2><p>设计立方体类(Cube)，求出立方体的面积( 2<em>a</em>b + 2<em>a</em>c + 2<em>b</em>c )和体积( a * b * c)，分别用全局函数和成员函数判断两个立方体是否相等。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cube</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">//设置长、宽、高</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Set_L</span><span class="params">(<span class="keyword">int</span> l)</span></span>&#123;m_L=l;&#125;  </span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Set_W</span><span class="params">(<span class="keyword">int</span> w)</span></span>&#123;m_W=w;&#125;  </span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Set_H</span><span class="params">(<span class="keyword">int</span> h)</span></span>&#123;m_H=h;&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//获取长、宽、高</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">Get_L</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> m_L;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">Get_W</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> m_W;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">Get_H</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> m_H;&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//求表面积</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">caculateS</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="number">2</span>*(m_L*m_W+m_L*m_H+m_L*m_H);&#125; </span><br><span class="line">	</span><br><span class="line">	<span class="comment">//求体积 </span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">caculateV</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> m_L*m_W*m_H;&#125; </span><br><span class="line">	</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> m_L;   <span class="comment">//长 </span></span><br><span class="line">	<span class="keyword">int</span> m_W;   <span class="comment">//宽 </span></span><br><span class="line">	<span class="keyword">int</span> m_H;   <span class="comment">//高 </span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Cube cube;</span><br><span class="line">	<span class="comment">//设置长、宽、高</span></span><br><span class="line">	cube.<span class="built_in">Set_L</span>(<span class="number">10</span>); </span><br><span class="line">	cube.<span class="built_in">Set_W</span>(<span class="number">10</span>); </span><br><span class="line">	cube.<span class="built_in">Set_H</span>(<span class="number">10</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//获取长、宽、高</span></span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;长:&quot;</span>&lt;&lt;cube.<span class="built_in">Get_L</span>()&lt;&lt;endl;</span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;宽:&quot;</span>&lt;&lt;cube.<span class="built_in">Get_W</span>()&lt;&lt;endl;</span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;高:&quot;</span>&lt;&lt;cube.<span class="built_in">Get_H</span>()&lt;&lt;endl;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//计算表面积</span></span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;面积：&quot;</span>&lt;&lt;cube.<span class="built_in">caculateS</span>()&lt;&lt;endl;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//计算体积</span></span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;体积：&quot;</span>&lt;&lt;cube.<span class="built_in">caculateV</span>()&lt;&lt;endl; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2、点和圆的关系"><a href="#2、点和圆的关系" class="headerlink" title="2、点和圆的关系"></a>2、点和圆的关系</h2><p>设计一个圆形类（Circle），和一个点类（Point），计算点和圆的关系。</p>
<p>假如圆心坐标为x0, y0, 半径为r，点的坐标为x1, y1：</p>
<ul>
<li>点在圆上：(x1-x0)<em>(x1-x0) + (y1-y0)</em>(y1-y0) == r*r</li>
<li>点在圆内：(x1-x0)<em>(x1-x0) + (y1-y0)</em>(y1-y0) &lt; r*r</li>
<li>点在圆外：(x1-x0)<em>(x1-x0) + (y1-y0)</em>(y1-y0) &gt; r*r</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">//设置坐标</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Set_XY</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;m_X=x;m_Y=y;&#125; </span><br><span class="line">	</span><br><span class="line">	<span class="comment">//获取坐标 </span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">Get_X</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> m_X;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">Get_Y</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> m_Y;&#125;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> m_X;   <span class="comment">//x坐标 </span></span><br><span class="line">	<span class="keyword">int</span> m_Y;   <span class="comment">//y坐标 </span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cicle</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">//设置圆心</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Set_CenetrPoint</span><span class="params">(Point point)</span></span>&#123;m_Point=point;&#125; </span><br><span class="line">	<span class="comment">//获取圆心 </span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">Get_CenterPointX</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> m_Point.<span class="built_in">Get_X</span>();&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">Get_centerPointY</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> m_Point.<span class="built_in">Get_Y</span>();&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//设置半径</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Set_R</span><span class="params">(<span class="keyword">int</span> r)</span></span>&#123;m_R=r;&#125;</span><br><span class="line">	<span class="comment">//获取半径 </span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">Get_R</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> m_R;&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//判断点和圆的关系</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">IsPointInCircle</span><span class="params">(Point point)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">/*int distance=(point.Get_X()-Get_CenterPointX())*(point.Get_X()-Get_CenterPointX())</span></span><br><span class="line"><span class="comment">		+(point.Get_Y()-Get_centerPointY())*(point.Get_Y()-Get_centerPointY());*/</span></span><br><span class="line">		<span class="keyword">int</span> distance=(point.<span class="built_in">Get_X</span>()-m_Point.<span class="built_in">Get_X</span>())*(point.<span class="built_in">Get_X</span>()-m_Point.<span class="built_in">Get_X</span>())</span><br><span class="line">		+(point.<span class="built_in">Get_Y</span>()-m_Point.<span class="built_in">Get_Y</span>())*(point.<span class="built_in">Get_Y</span>()-m_Point.<span class="built_in">Get_Y</span>());</span><br><span class="line">		<span class="keyword">if</span>(distance==(m_R*m_R))</span><br><span class="line">			cout&lt;&lt;<span class="string">&quot;点在圆上&quot;</span>&lt;&lt;endl;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(distance&gt;(m_R*m_R))</span><br><span class="line">			cout&lt;&lt;<span class="string">&quot;点在圆外&quot;</span>&lt;&lt;endl;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			cout&lt;&lt;<span class="string">&quot;点在圆内&quot;</span>&lt;&lt;endl; </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	Point m_Point;   <span class="comment">//圆心</span></span><br><span class="line">	<span class="keyword">int</span> m_R;        <span class="comment">//半径 </span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//全局函数判断点和圆的关系</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IsPointInCircle1</span><span class="params">(Point point,Cicle cicle)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> distance=(point.<span class="built_in">Get_X</span>()-cicle.<span class="built_in">Get_CenterPointX</span>())*(point.<span class="built_in">Get_X</span>()-cicle.<span class="built_in">Get_CenterPointX</span>())</span><br><span class="line">	+(point.<span class="built_in">Get_Y</span>()-cicle.<span class="built_in">Get_centerPointY</span>())*(point.<span class="built_in">Get_Y</span>()-cicle.<span class="built_in">Get_centerPointY</span>());</span><br><span class="line">	<span class="keyword">if</span>(distance==(cicle.<span class="built_in">Get_R</span>()*cicle.<span class="built_in">Get_R</span>()))</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot;点在圆上&quot;</span>&lt;&lt;endl;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(distance&gt;(cicle.<span class="built_in">Get_R</span>()*cicle.<span class="built_in">Get_R</span>()))</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot;点在圆外&quot;</span>&lt;&lt;endl;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		cout&lt;&lt;<span class="string">&quot;点在圆内&quot;</span>&lt;&lt;endl; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Point point;  <span class="comment">//圆心</span></span><br><span class="line">	Cicle cicle;  <span class="comment">//圆 </span></span><br><span class="line">	<span class="comment">//设置圆心</span></span><br><span class="line">	point.<span class="built_in">Set_XY</span>(<span class="number">10</span>,<span class="number">10</span>);</span><br><span class="line">	cicle.<span class="built_in">Set_CenetrPoint</span>(point);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//获取圆心 </span></span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;圆心:(&quot;</span>&lt;&lt;cicle.<span class="built_in">Get_CenterPointX</span>()&lt;&lt;<span class="string">&quot;,&quot;</span>&lt;&lt;cicle.<span class="built_in">Get_centerPointY</span>()&lt;&lt;<span class="string">&quot;)&quot;</span>&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//设置半径</span></span><br><span class="line">	cicle.<span class="built_in">Set_R</span>(<span class="number">5</span>);</span><br><span class="line">	<span class="comment">//获取半径 </span></span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;半径:&quot;</span>&lt;&lt;cicle.<span class="built_in">Get_R</span>()&lt;&lt;endl;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//点</span></span><br><span class="line">	Point point1;</span><br><span class="line">	point1.<span class="built_in">Set_XY</span>(<span class="number">10</span>,<span class="number">14</span>);</span><br><span class="line">	<span class="comment">//成员函数判断点和圆的关系</span></span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;成员函数函数判断下:&quot;</span> ;</span><br><span class="line">	cicle.<span class="built_in">IsPointInCircle</span>(point1);	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//全局函数判断点和圆的关系</span></span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;全局函数函数判断下:&quot;</span> ;</span><br><span class="line">	<span class="built_in">IsPointInCircle1</span>(point1,cicle);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smilesrx.github.io/2021/04/21/C++/C++%E5%A4%9A%E6%80%81/C++%E5%A4%9A%E6%80%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CandyKing">
      <meta itemprop="description" content="虾米">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆玺之路">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/21/C++/C++%E5%A4%9A%E6%80%81/C++%E5%A4%9A%E6%80%81/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-21 20:23:45" itemprop="dateCreated datePublished" datetime="2021-04-21T20:23:45+08:00">2021-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-21 23:36:23" itemprop="dateModified" datetime="2020-10-21T23:36:23+08:00">2020-10-21</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h1><p>多态性改善了代码的可读性和组织性，同时也使创建的程序具有可扩展性，项目不仅在最初创建时期可以扩展，而且当项目在需要有新的功能时也能扩展。</p>
<p>面向对象程序设计一个基本原则:开闭原则(对修改关闭，对扩展开放)</p>
<h1 id="静态多态、动态多态"><a href="#静态多态、动态多态" class="headerlink" title="静态多态、动态多态"></a>静态多态、动态多态</h1><p>c++支持编译时多态(静态多态)和运行时多态(动态多态)，运算符重载和函数重载就是编译时多态，派生类和虚函数实现运行时多态。</p>
<p><strong>静态多态和动态多态的区别就是函数地址是早绑定(静态联编)还是晚绑定(动态联编)：</strong></p>
<ul>
<li>如果函数的调用，在编译阶段就可以确定函数的调用地址，并产生代码，就是静态多态(编译时多态)，就是说地址是早绑定的</li>
<li>如果函数的调用地址不能在编译期间确定，而需要在运行时才能决定，这这就属于晚绑定(动态多态,运行时多态)。</li>
</ul>
<p><strong>动态多态产生的条件：</strong></p>
<ul>
<li>先有继承关系</li>
<li>父类中有虚函数（函数名前加关键字virtual），子类重写父类中的虚函数</li>
<li>父类的指针或引用  指向子类的对象</li>
</ul>
<h1 id="多态原理"><a href="#多态原理" class="headerlink" title="多态原理"></a>多态原理</h1><p>C++动态多态性是通过虚函数来实现的，虚函数允许子类（派生类）重新定义父类（基类）成员函数，而子类（派生类）重新定义父类（基类）虚函数的做法称为覆盖(override)，或者称为重写。</p>
<p>对于特定的函数进行动态绑定，c++要求在基类中声明这个函数的时候使用virtual关键字,动态绑定也就对virtual函数起作用.</p>
<ul>
<li>为创建一个需要动态绑定的虚成员函数，可以简单在这个函数声明前面加上virtual关键字，定义时候不需要.</li>
<li>如果一个函数在基类中被声明为virtual，那么在所有派生类中它都是virtual的.</li>
<li>在派生类中virtual函数的重定义称为重写(override).</li>
<li>Virtual关键字只能修饰成员函数.</li>
<li>构造函数不能为虚函数.</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">//虚函数</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">speak</span><span class="params">()</span></span>&#123;cout &lt;&lt; <span class="string">&quot;动物在说话&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">(<span class="keyword">int</span> a )</span></span>&#123;cout &lt;&lt; <span class="string">&quot;动物在吃饭&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span> :</span><span class="keyword">public</span> Animal&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">speak</span><span class="params">()</span></span>&#123;cout &lt;&lt; <span class="string">&quot;小猫在说话&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">eat</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123;cout &lt;&lt; <span class="string">&quot;小猫在吃饭&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> :</span><span class="keyword">public</span> Animal&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">speak</span><span class="params">()</span></span>&#123;cout &lt;&lt; <span class="string">&quot;小狗在说话&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DoSpeak</span><span class="params">(Animal &amp;animal)</span></span>&#123;</span><br><span class="line">	animal.<span class="built_in">speak</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">	Cat cat;</span><br><span class="line">	<span class="built_in">DoSpeak</span>(cat);</span><br><span class="line">	</span><br><span class="line">	Dog dog;</span><br><span class="line">	<span class="built_in">DoSpeak</span>(dog);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span>&#123;</span><br><span class="line">	Animal *animal=<span class="keyword">new</span> Cat;</span><br><span class="line">	<span class="comment">//调用猫说话</span></span><br><span class="line">	animal-&gt;<span class="built_in">speak</span>();</span><br><span class="line">	<span class="comment">// *(int *)animal 解引用到虚函数表中</span></span><br><span class="line">	<span class="comment">// *(int *)*(int *)animal 解引用到函数speak地址</span></span><br><span class="line">	((<span class="built_in"><span class="keyword">void</span></span>(*)()) (*(<span class="keyword">int</span> *)*(<span class="keyword">int</span> *)animal)) ();</span><br><span class="line"></span><br><span class="line">	<span class="comment">//C/C++默认调用惯例  __cdecl</span></span><br><span class="line">	<span class="comment">//用下列调用时候 真实调用惯例  是 __stdcall</span></span><br><span class="line">	<span class="comment">//调用猫吃饭</span></span><br><span class="line">	<span class="function"><span class="keyword">typedef</span> <span class="title">void</span><span class="params">( __stdcall *FUNPOINT)</span><span class="params">(<span class="keyword">int</span>)</span></span>;</span><br><span class="line">	(<span class="built_in">FUNPOINT</span> (*((<span class="keyword">int</span>*)*(<span class="keyword">int</span>*)animal)))(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>当父类写了虚函数后，类内部结构发生改变，多了一个<code>vfptr</code>—虚函数表指针</p>
</li>
<li><p>虚函数表内部记录着 虚函数的入口地址</p>
</li>
<li><p>当父类指针或引用指向子类对象，发生多态，调用是时候从虚函数中找函数入口地址</p>
</li>
<li><p>虚函数 关键字  virtual</p>
</li>
<li><p>纯虚函数 <code>virtual  int  func( )=0;</code></p>
<pre><code>如果一个类中包含了纯虚函数，那么这个类就无法实例化对象了,这个类通常我们称为 抽象类
抽象类的子类 必须要重写 父类中的纯虚函数，否则也属于抽象类
</code></pre>
</li>
<li><p>利用指针的偏移调用 函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">((<span class="built_in"><span class="keyword">void</span></span>(*)()) (*(<span class="keyword">int</span> *)*(<span class="keyword">int</span> *)animal)) ();</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">void</span><span class="params">( __stdcall *FUNPOINT)</span><span class="params">(<span class="keyword">int</span>)</span></span>;</span><br><span class="line">(<span class="built_in">FUNPOINT</span> (*((<span class="keyword">int</span>*)*(<span class="keyword">int</span>*)animal)))(<span class="number">10</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="多态案例—计算器实现"><a href="#多态案例—计算器实现" class="headerlink" title="多态案例—计算器实现"></a>多态案例—计算器实现</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AbstractCalculator</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">//纯虚函数</span></span><br><span class="line">	<span class="comment">//如果一个类中包含了纯虚函数，那么这个类就无法实例化对象了,这个类通常我们称为 抽象类</span></span><br><span class="line">	<span class="comment">//抽象类的子类 必须要重写 父类中的纯虚函数，否则也属于抽象类</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">getResult</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> m_A;</span><br><span class="line">	<span class="keyword">int</span> m_B;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//加法计算器</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AddCalculator</span> :</span><span class="keyword">public</span> AbstractCalculator&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">getResult</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> m_A + m_B;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//减法计算器</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SubCalculator</span> :</span><span class="keyword">public</span> AbstractCalculator&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">getResult</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> m_A - m_B;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//乘法计算器</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MulCalculator</span> :</span><span class="keyword">public</span> AbstractCalculator&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">getResult</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> m_A * m_B;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	AbstractCalculator * calculator = <span class="keyword">new</span> AddCalculator;</span><br><span class="line">	calculator-&gt;m_A = <span class="number">100</span>;</span><br><span class="line">	calculator-&gt;m_B = <span class="number">200</span>;</span><br><span class="line">	cout &lt;&lt; calculator-&gt;<span class="built_in">getResult</span>() &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">delete</span> calculator;</span><br><span class="line">    </span><br><span class="line">	calculator = <span class="keyword">new</span> SubCalculator;</span><br><span class="line">	calculator-&gt;m_A = <span class="number">100</span>;</span><br><span class="line">	calculator-&gt;m_B = <span class="number">200</span>;</span><br><span class="line">	cout &lt;&lt; calculator-&gt;<span class="built_in">getResult</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">delete</span> calculator;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="纯虚函数函数和抽象类"><a href="#纯虚函数函数和抽象类" class="headerlink" title="纯虚函数函数和抽象类"></a>纯虚函数函数和抽象类</h1><p>语法：<code>virtual int func() = 0;</code></p>
<p>如果一个类中包含了纯虚函数，那么这个类就无法实例化对象了,这个类通常我们称为 抽象类</p>
<p>抽象类的子类 必须要重写 父类中的纯虚函数，否则也属于抽象类</p>
<h1 id="虚析构和纯虚析构"><a href="#虚析构和纯虚析构" class="headerlink" title="虚析构和纯虚析构"></a>虚析构和纯虚析构</h1><h2 id="1、虚析构"><a href="#1、虚析构" class="headerlink" title="1、虚析构"></a>1、虚析构</h2><p>作用：虚析构函数是为了解决基类的指针指向派生类对象，并用基类的指针删除派生类对象。</p>
<p>语法：<code>virtual ~Person()&#123; &#125;</code></p>
<p>如果子类中有指向堆区的属性，那么要利用虚析构技术 在delete的时候 调用子类的析构函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Animal</span>()&#123;cout &lt;&lt; <span class="string">&quot;Animal的构造函数调用&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">speak</span><span class="params">()</span></span>&#123;cout &lt;&lt; <span class="string">&quot;动物在说话&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line">	<span class="comment">//如果子类中有指向堆区的属性，那么要利用虚析构技术 在delete的时候 调用子类的析构函数</span></span><br><span class="line">	<span class="keyword">virtual</span> ~<span class="built_in">Animal</span>()&#123;cout &lt;&lt; <span class="string">&quot;Animal的析构函数调用&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span> :</span><span class="keyword">public</span> Animal&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Cat</span>(<span class="keyword">char</span> * name)&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Cat的构造函数调用&quot;</span> &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">this</span>-&gt;m_Name = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">strlen</span>(name) + <span class="number">1</span>];</span><br><span class="line">		<span class="built_in">strcpy</span>(<span class="keyword">this</span>-&gt;m_Name, name);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">speak</span><span class="params">()</span></span>&#123;cout &lt;&lt; <span class="keyword">this</span>-&gt;m_Name &lt;&lt;<span class="string">&quot; 小猫在说话&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="built_in">Cat</span>()&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>-&gt;m_Name)&#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;Cat的析构函数调用&quot;</span> &lt;&lt; endl;</span><br><span class="line">			<span class="keyword">delete</span>[] <span class="keyword">this</span>-&gt;m_Name;</span><br><span class="line">			<span class="keyword">this</span>-&gt;m_Name = <span class="literal">NULL</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">char</span> * m_Name;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Animal * animal = <span class="keyword">new</span> <span class="built_in">Cat</span>(<span class="string">&quot;Tom&quot;</span>);   <span class="comment">//先：Animal构造    后：Cat构造 </span></span><br><span class="line">	animal-&gt;<span class="built_in">speak</span>();  <span class="comment">//小猫在说话</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">delete</span> animal;    <span class="comment">//先：Cat析构   后：Animal析构</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2、纯虚析构"><a href="#2、纯虚析构" class="headerlink" title="2、纯虚析构"></a>2、纯虚析构</h2><p>纯虚析构函数在c++中是合法的，但是在使用的时候有一个额外的限制：必须为纯虚析构函数提供一个函数体。</p>
<p>作用：纯虚析构函数和非纯析构函数之间唯一的不同之处在于纯虚析构函数使得基类是抽象类，不能创建基类的对象。</p>
<p>语法：<code>virtual ~Animal() = 0;</code>    <code>Animal::~Animal()&#123; .. &#125;</code></p>
<p>注意：</p>
<ul>
<li>纯虚析构 需要有声明 也需要有实现</li>
<li>如果一个类中 有了 纯虚析构函数，那么这个类也属于抽象类，无法实例化对象了</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Animal</span>()&#123;cout &lt;&lt; <span class="string">&quot;Animal的构造函数调用&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">speak</span><span class="params">()</span></span>&#123;cout &lt;&lt; <span class="string">&quot;动物在说话&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line">	<span class="comment">//如果子类中有指向堆区的属性，那么要利用虚析构技术 在delete的时候 调用子类的析构函数</span></span><br><span class="line">	<span class="comment">//纯虚析构 需要有声明 也需要有实现</span></span><br><span class="line">	<span class="comment">//如果一个类中 有了 纯虚析构函数，那么这个类也属于抽象类，无法实例化对象了</span></span><br><span class="line">	<span class="keyword">virtual</span> ~<span class="built_in">Animal</span>() = <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Animal::~<span class="built_in">Animal</span>()&#123;cout &lt;&lt; <span class="string">&quot;Animal的纯虚析构函数调用&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span> :</span><span class="keyword">public</span> Animal&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Cat</span>(<span class="keyword">char</span> * name)&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Cat的构造函数调用&quot;</span> &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">this</span>-&gt;m_Name = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">strlen</span>(name) + <span class="number">1</span>];</span><br><span class="line">		<span class="built_in">strcpy</span>(<span class="keyword">this</span>-&gt;m_Name, name);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">speak</span><span class="params">()</span></span>&#123;cout &lt;&lt; <span class="keyword">this</span>-&gt;m_Name &lt;&lt;<span class="string">&quot; 小猫在说话&quot;</span> &lt;&lt; endl;&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="built_in">Cat</span>()&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>-&gt;m_Name)&#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;Cat的析构函数调用&quot;</span> &lt;&lt; endl;</span><br><span class="line">			<span class="keyword">delete</span>[] <span class="keyword">this</span>-&gt;m_Name;</span><br><span class="line">			<span class="keyword">this</span>-&gt;m_Name = <span class="literal">NULL</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">char</span> * m_Name;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//Animal animal;   //纯虚析构使Animal为抽象类无法实例化对象</span></span><br><span class="line">	Animal * animal = <span class="keyword">new</span> <span class="built_in">Cat</span>(<span class="string">&quot;Tom&quot;</span>);</span><br><span class="line">	animal-&gt;<span class="built_in">speak</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">delete</span> animal;   <span class="comment">//调用子类的析构函数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="向上、向下类型转换"><a href="#向上、向下类型转换" class="headerlink" title="向上、向下类型转换"></a>向上、向下类型转换</h1><ul>
<li>父转子  向下类型转换  不安全</li>
<li>子转父  向上类型转换  安全</li>
<li>如果发生多态，那么转换永远都是安全的</li>
</ul>
<h1 id="重载-重定义-重写"><a href="#重载-重定义-重写" class="headerlink" title="重载- 重定义-重写"></a>重载- 重定义-重写</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">//同一作用域下，func1函数重载</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func1</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func1</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func2</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func3</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> :</span> <span class="keyword">public</span> A&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">//重定义基类的func2,隐藏了基类的func2方法</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func2</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">	<span class="comment">//重写基类的func3函数，也可以覆盖基类func3</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func3</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="1、重载"><a href="#1、重载" class="headerlink" title="1、重载"></a>1、重载</h2><ul>
<li>同一个作用域</li>
<li>函数名相同</li>
<li>参数表不同（参数类型、个数、顺序）</li>
<li>加<code>const</code>和不加<code>const</code>的引用</li>
<li>返回值不做重载的条件</li>
</ul>
<h2 id="2、重定义（隐藏）"><a href="#2、重定义（隐藏）" class="headerlink" title="2、重定义（隐藏）"></a>2、重定义（隐藏）</h2><ul>
<li>有继承</li>
<li>子类（派生类）重新定义父类（基类）的同名成员（非virtual函数）</li>
</ul>
<h2 id="3、重写（覆盖）—-多态"><a href="#3、重写（覆盖）—-多态" class="headerlink" title="3、重写（覆盖）—  多态"></a>3、重写（覆盖）—  多态</h2><ul>
<li> 有继承</li>
<li>子类（派生类）重写父类（基类）的virtual函数</li>
<li>函数返回值，函数名字，函数参数，必须和基类中的虚函数一致</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smilesrx.github.io/2021/04/21/C++/C++%E5%A4%9A%E4%B8%AA%E5%AF%B9%E8%B1%A1%E6%9E%84%E9%80%A0%E5%92%8C%E6%9E%90%E6%9E%84/%E5%A4%9A%E4%B8%AA%E5%AF%B9%E8%B1%A1%E6%9E%84%E9%80%A0%E5%92%8C%E6%9E%90%E6%9E%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CandyKing">
      <meta itemprop="description" content="虾米">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆玺之路">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/21/C++/C++%E5%A4%9A%E4%B8%AA%E5%AF%B9%E8%B1%A1%E6%9E%84%E9%80%A0%E5%92%8C%E6%9E%90%E6%9E%84/%E5%A4%9A%E4%B8%AA%E5%AF%B9%E8%B1%A1%E6%9E%84%E9%80%A0%E5%92%8C%E6%9E%90%E6%9E%84/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-21 20:23:45" itemprop="dateCreated datePublished" datetime="2021-04-21T20:23:45+08:00">2021-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-26 18:18:49" itemprop="dateModified" datetime="2020-10-26T18:18:49+08:00">2020-10-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="初始化列表"><a href="#初始化列表" class="headerlink" title="初始化列表"></a>初始化列表</h1><p>构造函数和其他函数不同，除了有名字，参数列表，函数体之外还有初始化列表</p>
<p><strong>注意：</strong>初始化成员列表(参数列表)只能在构造函数使用。</p>
<p>形式：`Student（string name,int age）：m_Name(name),m_Age(age){ }</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//一般初始化方式</span></span><br><span class="line">    <span class="built_in">Student</span>(string name,<span class="keyword">int</span> age)</span><br><span class="line">    &#123;</span><br><span class="line">        m_Name=name;</span><br><span class="line">        m_Age=age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//利用初始化列表初始化</span></span><br><span class="line">    <span class="built_in">Student</span>(<span class="keyword">int</span> age,string name):<span class="built_in">m_Age</span>(age),<span class="built_in">m_Name</span>(name)&#123; &#125;</span><br><span class="line">    string m_Name;</span><br><span class="line">    <span class="keyword">int</span> m_Age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Student <span class="title">stu</span><span class="params">(<span class="string">&quot;兔子牙&quot;</span>,<span class="number">22</span>)</span></span>;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;stu.m_Name&lt;&lt;<span class="string">&quot;  年龄：&quot;</span>&lt;&lt;stu.m_Age&lt;&lt;endl;  <span class="comment">//姓名：兔子牙  年龄：22 </span></span><br><span class="line">    <span class="function">Student <span class="title">stu1</span><span class="params">(<span class="number">23</span>,<span class="string">&quot;野小马&quot;</span>)</span></span>;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;stu1.m_Name&lt;&lt;<span class="string">&quot;  年龄：&quot;</span>&lt;&lt;stu1.m_Age&lt;&lt;endl;   <span class="comment">//姓名：野小马  年龄：23 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="类对象作为类成员（对象成员）"><a href="#类对象作为类成员（对象成员）" class="headerlink" title="类对象作为类成员（对象成员）"></a>类对象作为类成员（对象成员）</h1><p>在类中定义的数据成员一般都是基本的数据类型。但是类中的成员也可以是对象，叫做<strong>对象成员</strong>。</p>
<p>C++中对对象的初始化是非常重要的操作，当创建一个对象的时候，c++编译器必须确保调用了所有子对象的构造函数。如果所有的子对象有默认构造函数，编译器可以自动调用他们。但是<strong>如果子对象没有默认的构造函数</strong>，或者想指定调用某个构造函数怎么办？</p>
<p>那么是否可以在类的构造函数直接调用子类的属性完成初始化呢？但是如果<strong>子类的成员属性是私有的，我们是没有办法访问并完成初始化的</strong>。</p>
<p>解决办法非常简单：对于子类调用构造函数，c++为此提供了专门的语法，即构造函数初始化列表。</p>
<p>当调用构造函数时，首先按各对象成员在类定义中的顺序（和参数列表的顺序无关）依次调用它们的构造函数，对这些对象初始化，最后再调用本身的函数体。也就是说，先调用对象成员的构造函数，再调用本身的构造函数。</p>
<p>析构函数和构造函数调用顺序相反，先构造，后析构。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Car</span>(string name):<span class="built_in">m_Car_Name</span>(name)&#123;cout&lt;&lt;<span class="string">&quot;Car类构造函数调用&quot;</span>&lt;&lt;endl;&#125;</span><br><span class="line">    ~<span class="built_in">Car</span>()&#123;cout&lt;&lt;<span class="string">&quot;Car类析构函数调用&quot;</span>&lt;&lt;endl;&#125;</span><br><span class="line">    </span><br><span class="line">    string m_Car_Name;</span><br><span class="line">&#125;; </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Place</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Place</span>(string name):<span class="built_in">m_Place_Name</span>(name)&#123;cout&lt;&lt;<span class="string">&quot;Palce类构造函数调用&quot;</span>&lt;&lt;endl;&#125;</span><br><span class="line">    ~<span class="built_in">Place</span>()&#123;cout&lt;&lt;<span class="string">&quot;Place类析构函数调用&quot;</span>&lt;&lt;endl;&#125;</span><br><span class="line">    </span><br><span class="line">    string m_Place_Name; </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Person</span>(string name,Car car,Place place):<span class="built_in">m_Name</span>(name),<span class="built_in">m_Car</span>(car.m_Car_Name),<span class="built_in">m_Place</span>(place.m_Place_Name)</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;Person类构造函数调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    ~<span class="built_in">Person</span>()&#123;cout&lt;&lt;<span class="string">&quot;Person类析构函数调用&quot;</span>&lt;&lt;endl;&#125;</span><br><span class="line">    </span><br><span class="line">    Car m_Car;</span><br><span class="line">    Place m_Place;  <span class="comment">//这里会影响子类构造函数调用的顺序（与参数列表的顺序无关）</span></span><br><span class="line">    <span class="comment">//Car m_Car;</span></span><br><span class="line">    string m_Name;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Car <span class="title">car</span><span class="params">(<span class="string">&quot;宝马&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">Place <span class="title">place</span><span class="params">(<span class="string">&quot;KTV&quot;</span>)</span></span>;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------------------1--------------&quot;</span>&lt;&lt;endl; </span><br><span class="line">    <span class="function">Person <span class="title">person</span><span class="params">(<span class="string">&quot;阳仔&quot;</span>,car,place)</span></span>;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------------------2--------------&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;person.m_Name&lt;&lt;<span class="string">&quot;开着&quot;</span>&lt;&lt;person.m_Car.m_Car_Name&lt;&lt;<span class="string">&quot;车去&quot;</span>&lt;&lt;person.m_Place.m_Place_Name&lt;&lt;<span class="string">&quot;泡妞了&quot;</span>&lt;&lt;endl;  </span><br><span class="line">              <span class="comment">//阳仔开着宝马车去泡妞了</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试结果：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Car类构造函数调用                                                                                      Palce类构造函数调用                                                                                 -----------------<span class="number">-1</span>--------------                                                                                   </span><br><span class="line">Car类构造函数调用                                                                                     Palce类构造函数调用                                                                                    Person类构造函数调用                                                                                 Car类析构函数调用                                                                                     Place类析构函数调用                                                                                    -----------------<span class="number">-2</span>--------------                                                                   阳仔开着宝马车去KTV泡妞了                                                                             Person类析构函数调用                                                                                 Place类析构函数调用                                                                                   Car类析构函数调用                                                                                      Place类析构函数调用                                                                                 Car类析构函数调用 </span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smilesrx.github.io/2021/04/21/C++/C++%E5%8A%A8%E6%80%81%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/%E5%8A%A8%E6%80%81%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CandyKing">
      <meta itemprop="description" content="虾米">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆玺之路">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/21/C++/C++%E5%8A%A8%E6%80%81%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/%E5%8A%A8%E6%80%81%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-21 20:23:45" itemprop="dateCreated datePublished" datetime="2021-04-21T20:23:45+08:00">2021-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-13 21:24:03" itemprop="dateModified" datetime="2020-10-13T21:24:03+08:00">2020-10-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="动态内存分配"><a href="#动态内存分配" class="headerlink" title="动态内存分配"></a>动态内存分配</h1><p>当我们创建数组的时候，总是需要提前预定数组的长度，然后编译器分配预定长度的数组空间，在使用数组的时，会有这样的问题，数组也许空间太大了，浪费空间，也许空间不足，所以对于数组来讲，如果能根据需要来分配空间大小再好不过。</p>
<p>为了解决这个普遍的编程问题，在运行中可以创建和销毁对象是最基本的要求。当然c早就提供了动态内存分配,函数<code>malloc</code>和<code>free</code>可以在运行时从堆中分配存储单元。</p>
<h2 id="1、malloc-—-申请动态内存"><a href="#1、malloc-—-申请动态内存" class="headerlink" title="1、malloc — 申请动态内存"></a>1、malloc — 申请动态内存</h2><p><code>malloc(sizeof(num))</code>向系统申请<code>sizeof(num)</code>字节的动态内存，内存于“堆”里存放，若申请成功，则函数返回(void * 指针类型)，失败则返回NULL，并且申请之后的内存中并没有初始化。该函数需要引用头文件—<code>stdlib.h</code>。</p>
<p>由于“堆”有一个特性——由程序自行管理内存，所以在申请了动态内存之后，需要利用<code>free()</code>自行释放，这是为了避免出现野指针，并且把指向这块内存的指针指向NULL，防止之后的程序再用到这个指针。如果不自行释放的话，就会造成内存泄露——可用内存越来越少，设备速度越来越慢。</p>
<p><code>malloc(num)</code>代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> *pArr=<span class="built_in">malloc</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>)*<span class="number">10</span>);    <span class="comment">//堆区申请10个int类型大小的内存</span></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        pArr[i]=<span class="number">10</span>+i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">10</span>;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,pArr[j]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(pArr);</span><br><span class="line">    pArr=<span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2、calloc-—-申请动态内存且进行初始化"><a href="#2、calloc-—-申请动态内存且进行初始化" class="headerlink" title="2、calloc — 申请动态内存且进行初始化"></a>2、calloc — 申请动态内存且进行初始化</h2><p>函数原型：<code>void *calloc(size_t nitems, size_t size)</code></p>
<ul>
<li><code>nitems</code> – 要被分配的元素个数。</li>
<li><code>size</code> – 元素的大小。</li>
<li>返回一个指针，指向已分配的内存。如果请求失败，则返回 NULL。</li>
</ul>
<p><code>calloc(nitems,size)</code>代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> *pArr=<span class="built_in">calloc</span>(<span class="number">10</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>));</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,pArr[i]);                <span class="comment">//被初始化为0</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">char</span> *pArr1=<span class="built_in">calloc</span>(<span class="number">10</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">char</span>));</span><br><span class="line">    <span class="keyword">int</span> k=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(;k&lt;<span class="number">10</span>;k++)</span><br><span class="line">    &#123;</span><br><span class="line">    	pArr1[k]=k+<span class="number">65</span>;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(;j&lt;<span class="number">10</span>;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c &quot;</span>,pArr1[j]);      <span class="comment">//A B C D E F G H I J </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3、realloc-—-对原动态内存块进行扩容"><a href="#3、realloc-—-对原动态内存块进行扩容" class="headerlink" title="3、realloc — 对原动态内存块进行扩容"></a>3、realloc — 对原动态内存块进行扩容</h2><p>函数原型：<code>void realloc(void ptr, size_t size)</code></p>
<p>尝试重新调整之前调用 <code>malloc</code> 或 <code>calloc</code> 所分配的<code> ptr</code>所指向的内存块的大小</p>
<ul>
<li><code>ptr</code> – 指针指向一个要重新分配内存的内存块，该内存块之前是通过调用 <code>malloc</code>、<code>calloc</code> 或 <code>realloc</code> 进行分配内存的。如果为空指针，则会分配一个新的内存块，且函数返回一个指向它的指针。</li>
<li><code>size</code> – 内存块的新的大小，以字节为单位。如果大小为 0，且 <code>ptr</code> 指向一个已存在的内存块，则 <code>ptr</code> 所指向的内存块会被释放，并返回一个空指针</li>
</ul>
<p><code>realloc(ptr,size)</code>代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> *ptr=<span class="built_in">malloc</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>)*<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">int</span> *re_ptr=<span class="built_in">malloc</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>)*<span class="number">10</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;旧地址：%p\n&quot;</span>,ptr);       <span class="comment">//旧地址：00000000001813E0 </span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;新地址：%p\n&quot;</span>,re_ptr);    <span class="comment">//新地址：0000000000181400 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4、free-—-释放内存空间"><a href="#4、free-—-释放内存空间" class="headerlink" title="4、free — 释放内存空间"></a>4、free — 释放内存空间</h2><p>千万别忘记释放内存块，这会造成内存泄露这样严重的问题</p>
<p><code>free()</code>函数只需要将指向该内存块的指针作为参数传入，就可以释放这块内存</p>
<p>**注意:**释放的是这一块内存，而不是指向这一块内存块的指针p，所以在free(p)之后，有必要将p赋值为NULL，避免之后的程序用到它，程序会崩溃的，因为这是一个野指针。</p>
<p><code>free(p)</code>代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">free</span>(p);</span><br><span class="line">p=<span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure>

<h1 id="对象创建"><a href="#对象创建" class="headerlink" title="对象创建"></a>对象创建</h1><p>当创建一个c++对象时会发生两件事:</p>
<ol>
<li>为对象分配内存</li>
<li>调用构造函数来初始化那块内存</li>
</ol>
<p>第一步我们能保证实现，需要我们确保第二步一定能发生。</p>
<p>c++强迫我们这么做是因为使用未初始化的对象是程序出错的一个重要原因。</p>
<h2 id="1、C-创建对象时C动态分配内存函数的缺陷"><a href="#1、C-创建对象时C动态分配内存函数的缺陷" class="headerlink" title="1、C++创建对象时C动态分配内存函数的缺陷"></a>1、C++创建对象时C动态分配内存函数的缺陷</h2><ul>
<li>程序员必须确定对象的长度。</li>
<li><code>malloc</code>返回一个void指针，c++不允许将void*赋值给其他任何指针，必须强转。</li>
<li><code>malloc</code>可能申请内存失败，所以必须判断返回值来确保内存分配成功。</li>
<li>用户在使用对象之前必须记住对他初始化，构造函数不能显示调用初始化(构造函数是由编译器调用)，用户有可能忘记调用初始化函数。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Person</span>(<span class="keyword">char</span> *name,<span class="keyword">int</span> age)</span><br><span class="line">    &#123;</span><br><span class="line">        m_Name=(<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="built_in">strlen</span>(name)+<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">strcpy</span>(m_Name,name);</span><br><span class="line">        m_Age=age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        m_Name=(<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="built_in">strlen</span>(<span class="string">&quot;卢本伟&quot;</span>)+<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">strcpy</span>(m_Name,<span class="string">&quot;卢本伟&quot;</span>);</span><br><span class="line">        m_Age=<span class="number">35</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Clean</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(m_Name)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">free</span>(m_Name);</span><br><span class="line">            m_Name=<span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">char</span> *m_Name;</span><br><span class="line">    <span class="keyword">int</span> m_Age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Person *person=(Person *)<span class="built_in">malloc</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(Person));   <span class="comment">//未调用构造函数，但用户又不能显式调用构造函数(无法初始化对象)</span></span><br><span class="line">    <span class="keyword">if</span>(!person)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    <span class="comment">//调用初始化函数---初始化对象</span></span><br><span class="line">    person-&gt;<span class="built_in">Init</span>();</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;person-&gt;m_Name&lt;&lt;<span class="string">&quot;  年龄：&quot;</span>&lt;&lt;person-&gt;m_Age&lt;&lt;endl;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//清理对象成员内存</span></span><br><span class="line">    person-&gt;<span class="built_in">Clean</span>();</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//清理对象内存</span></span><br><span class="line">    <span class="built_in">free</span>(person);</span><br><span class="line">    person=<span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2、new运算符"><a href="#2、new运算符" class="headerlink" title="2、new运算符"></a>2、new运算符</h2><p>C++中解决动态内存分配的方案是把创建一个对象所需要的操作都结合在一个称为new的运算符里。</p>
<p>当用new创建一个对象时，它就在堆里为对象分配内存并调用构造函数完成初始化。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Person *person=<span class="keyword">new</span> Person;</span><br><span class="line"><span class="comment">//底层实现相当于</span></span><br><span class="line">Person *person=(Person *)<span class="built_in">malloc</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(Person));</span><br><span class="line"><span class="keyword">if</span>(!person)</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">person-&gt;<span class="built_in">Init</span>();    <span class="comment">//相当于构造函数</span></span><br></pre></td></tr></table></figure>

<p>New操作符能确定在调用构造函数初始化之前内存分配是成功的，所有不用显式确定调用是否成功。</p>
<p>new运算符有内置的长度计算、类型转换和安全检查</p>
<h2 id="3、delete运算符"><a href="#3、delete运算符" class="headerlink" title="3、delete运算符"></a>3、delete运算符</h2><p>delete表达式先调用析构函数，然后释放内存。正如new表达式返回一个指向对象的指针一样，delete需要一个对象的地址。</p>
<p>delete只适用于由new创建的对象。</p>
<p>如果使用一个由<code>malloc</code>或者<code>calloc</code>或者<code>realloc</code>的对象使用<code>delete</code>,这个行为是未定义的。因为大多数<code>new</code>和<code>delete</code>的实现机制都使用了<code>malloc</code>和<code>free</code>,所以很可能没有调用析构函数就释放了内存。</p>
<p>如果正在删除的对象的指针是NULL,将不发生任何事，因此建议在删除指针后，立即把指针赋值为NULL，以免对它删除两次，对一些对象删除两次可能会产生某些问题。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Student</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        m_Name=(<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="built_in">strlen</span>(<span class="string">&quot;宫本武藏&quot;</span>)+<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">strcpy</span>(m_Name,<span class="string">&quot;宫本武藏&quot;</span>);</span><br><span class="line">        m_Age=<span class="number">45</span>;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;默认构造调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Student</span>(<span class="keyword">char</span> *name,<span class="keyword">int</span> age)</span><br><span class="line">    &#123;</span><br><span class="line">        m_Name=(<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="built_in">strlen</span>(name)+<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">strcpy</span>(m_Name,name);</span><br><span class="line">        m_Age=age;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;有参构造函数调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    ~<span class="built_in">Student</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(m_Name)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">free</span>(m_Name);</span><br><span class="line">            m_Name=<span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;析构函数调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">char</span> *m_Name;</span><br><span class="line">    <span class="keyword">int</span> m_Age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Student *stu=<span class="keyword">new</span> Student;    <span class="comment">//默认构造调用 </span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;stu-&gt;m_Name&lt;&lt;<span class="string">&quot;年龄：&quot;</span>&lt;&lt;stu-&gt;m_Age&lt;&lt;endl;   <span class="comment">//姓名：宫本武藏年龄：45 </span></span><br><span class="line">    </span><br><span class="line">    Student *stu1=<span class="keyword">new</span> <span class="built_in">Student</span>(<span class="string">&quot;娜可露露&quot;</span>,<span class="number">50</span>);    <span class="comment">//有参构造函数调用  </span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;stu1-&gt;m_Name&lt;&lt;<span class="string">&quot;年龄：&quot;</span>&lt;&lt;stu1-&gt;m_Age&lt;&lt;endl;   <span class="comment">//姓名：娜可露露年龄：50 </span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">delete</span> stu;</span><br><span class="line">    <span class="keyword">delete</span> stu1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="用于数组的new和delete—堆区"><a href="#用于数组的new和delete—堆区" class="headerlink" title="用于数组的new和delete—堆区"></a>用于数组的new和delete—堆区</h1><h2 id="1、创建一般类型（int、char…）数组"><a href="#1、创建一般类型（int、char…）数组" class="headerlink" title="1、创建一般类型（int、char…）数组"></a>1、创建一般类型（int、char…）数组</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建整型数组</span></span><br><span class="line"><span class="keyword">int</span> *IArr=<span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line"><span class="comment">//创建字符数组</span></span><br><span class="line"><span class="keyword">char</span> *CArr=<span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">50</span>];</span><br><span class="line"><span class="comment">//创建整型数组并初始化</span></span><br><span class="line"><span class="keyword">int</span> *pArr=<span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">5</span>]&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line"><span class="comment">//释放内存</span></span><br><span class="line"><span class="keyword">delete</span> IArr;</span><br><span class="line"><span class="keyword">delete</span> CArr;</span><br><span class="line"><span class="keyword">delete</span> pArr;</span><br></pre></td></tr></table></figure>

<h2 id="2、创建对象数组"><a href="#2、创建对象数组" class="headerlink" title="2、创建对象数组"></a>2、创建对象数组</h2><p>当创建一个对象数组的时候，必须对数组中的每一个对象调用构造函数，除了在栈上可以聚合初始化，必须提供一个默认的构造函数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Person</span>():<span class="built_in">m_Name</span>(<span class="string">&quot;不知火舞&quot;</span>),<span class="built_in">m_Age</span>(<span class="number">55</span>)&#123;cout&lt;&lt;<span class="string">&quot;默认构造调用&quot;</span>&lt;&lt;endl;&#125;</span><br><span class="line">    <span class="built_in">Person</span>(string name,<span class="keyword">int</span> age):<span class="built_in">m_Name</span>(name),<span class="built_in">m_Age</span>(age)&#123;cout&lt;&lt;<span class="string">&quot;有参构造调用&quot;</span>&lt;&lt;endl;&#125;</span><br><span class="line">    <span class="built_in">Print</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;m_Name&lt;&lt;<span class="string">&quot; 年龄：&quot;</span>&lt;&lt;m_Age&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    ~<span class="built_in">Person</span>()&#123;cout&lt;&lt;<span class="string">&quot;析构调用&quot;</span>&lt;&lt;endl;&#125;</span><br><span class="line">    string m_Name;</span><br><span class="line">    <span class="keyword">int</span> m_Age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//1.栈上聚合初始化</span></span><br><span class="line">    Person person[]=&#123;<span class="built_in">Person</span>(<span class="string">&quot;后羿&quot;</span>,<span class="number">45</span>),<span class="built_in">Person</span>(<span class="string">&quot;鲁班七号&quot;</span>,<span class="number">41</span>)&#125;;</span><br><span class="line">    <span class="keyword">int</span> len=<span class="built_in"><span class="keyword">sizeof</span></span>(person)/<span class="built_in"><span class="keyword">sizeof</span></span>(person[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        person[i].<span class="built_in">Print</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;--------------------------------&quot;</span>&lt;&lt;endl;</span><br><span class="line">    <span class="comment">//2.在堆区通过默认构造初始化</span></span><br><span class="line">    Person *Pperson=<span class="keyword">new</span> Person[<span class="number">3</span>];</span><br><span class="line">    Pperson-&gt;<span class="built_in">Print</span>();</span><br><span class="line">    <span class="keyword">delete</span>[] Pperson;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试结果：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">有参构造调用                                                                                                         有参构造调用                                                                                                         姓名：后羿 年龄：<span class="number">45</span>                                                                                                   姓名：鲁班七号 年龄：<span class="number">41</span>                                                                                               --------------------------------                                                                                   默认构造调用                                                                                                         默认构造调用                                                                                                         默认构造调用                                                                                                         姓名：不知火舞 年龄：<span class="number">55</span>                                                                                               析构调用                                                                                                             析构调用                                                                                                             析构调用                                                                                                             析构调用                                                                                                             析构调用 </span><br></pre></td></tr></table></figure>

<h2 id="3、delete-void"><a href="#3、delete-void" class="headerlink" title="3、delete void*"></a>3、delete void*</h2><p> 如果对一个void*指针执行delete操作，这将可能成为一个程序错误，除非指针指向的内容是非常简单的，因为它将不执行析构函数.以下代码未调用析构函数，导致可用内存减少。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Student</span>(<span class="keyword">char</span> *name,<span class="keyword">int</span> age)</span><br><span class="line">    &#123;</span><br><span class="line">        m_Name=(<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="built_in">strlen</span>(name)+<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">strcpy</span>(m_Name,name);</span><br><span class="line">        m_Age=age;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;有参构造调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    ~<span class="built_in">Student</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(m_Name)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">free</span>(m_Name);</span><br><span class="line">            m_Name=<span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;析构调用&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">char</span> * m_Name;</span><br><span class="line">    <span class="keyword">int</span> m_Age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">void</span> * stu=<span class="built_in"><span class="keyword">new</span></span>(<span class="string">&quot;安琪拉&quot;</span>，<span class="number">30</span>);          <span class="comment">//有参构造调用 </span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;姓名：&quot;</span>&lt;&lt;stu-&gt;m_Name&lt;&lt;<span class="string">&quot; 年龄&quot;</span>&lt;&lt;stu-&gt;m_Age&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">delete</span> stu;    <span class="comment">//未调用析构函数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//[Warning] deleting &#x27;void*&#x27; is undefined</span></span><br></pre></td></tr></table></figure>

<h2 id="4、使用-new-和-delete-采用相同的形式"><a href="#4、使用-new-和-delete-采用相同的形式" class="headerlink" title="4、使用 new 和 delete 采用相同的形式"></a>4、使用 new 和 delete 采用相同的形式</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Student *stu=<span class="keyword">new</span> Student[<span class="number">10</span>];</span><br><span class="line"><span class="keyword">delete</span> stu;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>测试结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">默认构造调用                                                                                                  默认构造调用                                                                                                 默认构造调用                                                                                                 默认构造调用                                                                                                 默认构造调用                                                                                                 默认构造调用                                                                                                 默认构造调用                                                                                                 默认构造调用                                                                                                 默认构造调用                                                                                                 默认构造调用</span><br><span class="line">析构调用</span><br></pre></td></tr></table></figure></li>
<li><p>分析：</p>
<p>使用了new也搭配使用了delete，问题在于Student有10个对象，那么其他9个对象可能没有调用析构函数，也就是说其他9个对象可能删除不完全，因为它们的析构函数没有被调用。</p>
<p>我们现在清楚使用new的时候发生了两件事：</p>
<ul>
<li>分配内存；</li>
<li>调用构造函数。</li>
</ul>
<p>那么调用delete的时候也有两件事：</p>
<ul>
<li>析构函数；</li>
<li>释放内存。</li>
</ul>
<p>那么刚才我们那段代码的问题在于：<code>stu</code>指针指向的内存中到底有多少个对象，因为这个决定应该有多少个析构函数应该被调用。</p>
<p>换句话说，<code>stu</code>指针指向的是一个单一的对象还是一个数组对象，由于单一对象和数组对象的内存布局是不同的。</p>
<p>更明确的说，数组所用的内存通常还包括“数组大小记录”，使得delete的时候知道应该调用几次析构函数。单一对象的话就没有这个记录。</p>
<p><img src="/%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1%E3%80%81%E5%8D%95%E4%B8%80%E5%AF%B9%E8%B1%A1%E5%86%85%E5%AD%98%E5%BD%A2%E5%BC%8F.png" alt="数组对象、单一对象内存形式"></p>
<p>当我们使用一个delete的时候，我们必须让delete知道指针指向的内存空间中是否存在一个“数组大小记录”的办法就是我们告诉它。当我们使用delete[ ]，那么delete就知道是一个对象数组，从而清楚应该调用几次析构函数。</p>
</li>
<li><p>结论：</p>
<p>当我们使用一个delete的时候，我们必须让delete知道指针指向的内存空间中是否存在一个“数组大小记录”的办法就是我们告诉它。当我们使用delete[]，那么delete就知道是一个对象数组，从而清楚应该调用几次析构函数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Student *stu=<span class="keyword">new</span> Student[<span class="number">3</span>];</span><br><span class="line"><span class="keyword">delete</span> []stu;</span><br></pre></td></tr></table></figure>

<p>测试结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">默认构造调用                                                                                                 默认构造调用                                                                                                 默认构造调用                                                                                                 析构调用                                                                                                      析构调用                                                                                                     析构调用</span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">CandyKing</p>
  <div class="site-description" itemprop="description">虾米</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">76</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CandyKing</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
